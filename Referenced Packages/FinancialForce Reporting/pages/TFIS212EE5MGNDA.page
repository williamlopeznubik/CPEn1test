<!-- User Note: TFIS212EE5MGNDA Reporting Template With Sub-Totalling Groups, 2 Total Colums And 2 Sum Type Reporting Values -->
<!-- User Note: This Template Has Value Groups 01-05 Which Automtically Subtotal, Value Groups 10-20 Used For Display Purposes -->
<!-- User Note: The Template Expects 2 Sum type Reporting Values -->
<!-- User Note: The Template Is Generic. It Expects Labels 10-13 & 45 For Each Of The Calculations. Template Only Uses A Single Data Range. -->
<!-- User Note: Special Features: Income Statement With Specific Calculations for Gross And Net Margin As Well As %. Mixed Values, Reversed For Sales And Normal For Expenses. With 2 Decimal Places. Value Groups 01-05 Automatic Subtotal, Groups 10-20 For Display Purposes. -->
<!-- REGION 01: GENERAL CONFIGURATION START-->
<!-- User Note: I Want To Use The Reporting Engine To Generate Reports -->
<apex:page standardController="ffr__ReportingDefinition__c" extensions="ffr.ReportingTemplateController" readOnly="true" showHeader="true" sidebar="false" standardStylesheets="false" renderas="{!RenderReportAs}">
<!-- User Note: I Want To Have A Single Format For All Of My Reports So That I Can Style The Fonts And Colors -->
<!-- User Note: A Standard Stylesheet Has Been Provided In The Static Resources -->
<!-- User Note: You Can Create Your Own Stylsheet In The Static Resources And Apply It To Your Reports -->
<!-- User Note: The Style Has Been Designed To Allow Variations Within Different Types Of Reports -->
<!-- User Note: Change The Last Character From D To S On The Style Classes Applied To Each Line Will Produce A Summary Report -->
<!-- User Note: A Summary Report Hides The Lowest Level Of Rows But Retains Calculations -->
<apex:stylesheet value="{!URLFOR($Resource.ffr__ReportingDefaultStyles, 'ReportingDefaultStyles.css')}"/>
<apex:stylesheet value="{!StyleSheetName}"/>
<!-- Variable to represent boolean true/false when needing to set other variables to these states -->
<apex:variable var="true" value="{!1=1}"/>
<apex:variable var="false" value="{!1=0}"/>
<!-- User Note: I Want To Format Values On A Report In Different Ways -->
<!-- User Note: A Number Formatter Component Has Been Provided To Support Different Formats -->
<!-- User Note: The Coding Structure For The Variable Is As Follows Value/Percent Numberofdecimals Normal/Reversed Brakets/Minus 3Charcterinternationalcurrencycode/None-->
<!-- User Note: Good Practice Is To Reverse Values Using A Format Rather Than Create Calculations On The Visualforce Page So Running Totals Can Be Easily Maintained-->
<!-- User Note: You Can Add Your Own Formats To The List Below Try To Keep A Good Coding Structure-->
<apex:variable var="V2NCB" value="#,###,###,##0.00;(#,###,###,##0.00);0.00"/>
<apex:variable var="P2NCB" value="#,###,###,##0.00%;(#,###,###,##0.00%);0.00%"/>
<apex:variable var="V0NCB" value="#,###,###,##0;(#,###,###,##0);0"/>
<apex:variable var="P0NCB" value="#,###,###,##0%;(#,###,###,##0%);0%"/>
<apex:variable var="V2RCB" value="(#,###,###,##0.00);#,###,###,##0.00;0.00"/>
<apex:variable var="P2RCB" value="(#,###,###,##0.00%);#,###,###,##0.00%;0.00%"/>
<apex:variable var="V0RCB" value="(#,###,###,##0);#,###,###,##0;0"/>
<apex:variable var="P0RCB" value="(#,###,###,##0%);#,###,###,##0%;0%"/>
<apex:variable var="V2NCBUSD" value="$#,###,###,##0.00;$(#,###,###,##0.00);$0.00"/>
<apex:variable var="V2RCBUSD" value="$(#,###,###,##0.00);$#,###,###,##0.00;$0.00"/>
<!-- User Note: I Want To Change All Of The Value Formats Quickly Across The Whole Of The Report -->
<!-- User Note: Having The Variables Above Assigned To A Second Variable Here Means That Just Changing This Field Will -->
<!-- User Note: Apply The Results To All The Fields Where It Is Used -->
<!-- User Note: It Is Possible To Use Individual Variables Against A Line This Method Allows You To Make A Single Change To All Related Formats -->
<apex:variable var="VN" value="{!V2NCB}"/>
<apex:variable var="PN" value="{!P2NCB}"/>
<apex:variable var="VR" value="{!V2RCB}"/>
<apex:variable var="PR" value="{!P2RCB}"/>

<!-- REGION 01: GENERAL CONFIGURATION END-->
<!-- REGION 02: REPORT HEADER START -->
<!-- Demand The Report Definition Fields To Be Loaded Even If Data Is Not Found -->
<apex:outputText value="{!ffr__ReportingDefinition__c.Name}" rendered="false"/>
<apex:outputText value="{!ffr__ReportingDefinition__c.ffr__Description__c}" rendered="false"/>
<apex:outputText value="{!ffr__ReportingDefinition__c.ffr__Title__c}" rendered="false"/>
<apex:outputText value="{!ffr__ReportingDefinition__c.ffr__DisplayPrompts__c}" rendered="false"/>
<apex:outputText value="{!ffr__ReportingDefinition__c.ffr__ReportingTemplate__c}" rendered="false"/>
<apex:outputText value="{!ffr__ReportingDefinition__c.ffr__StyleSheet__c}" rendered="false"/>
<apex:outputText value="{!ffr__ReportingDefinition__c.ffr__PrintStyleSheet__c}" rendered="false"/>
<apex:outputText value="{!ffr__ReportingDefinition__c.ffr__CompanyLogo__c}" rendered="false"/>
<apex:outputText value="{!ffr__ReportingDefinition__c.ffr__PrintChatterFeed__c}" rendered="false"/>
<!-- User Note: Show The Error Messages From The Reporting Engine -->

<apex:pageBlock title="Messages" rendered="{!hasMessages}">
<apex:messages />
</apex:pageBlock>
<div class="chatterPosition"></div>
<!-- User Note: I Want A Consistent Header Format To All Of My Reports With Titles Descriptions And Runtime Prompts Etc -->
<!-- User Note: When Creating New Templates This Well Formatted Header Should Be Copied And Used Across All The Reports -->
<table class="ffrgridd">
<tr>
<td><apex:image url="{!URLFOR(StaticResourceImages, CompanyLogo)}" rendered="{!DisplayCompanyLogo}" styleClass="logoReport"/></td>
</tr>
<tr>
<td><h1 class="ffrtitle">{!ffr__ReportingDefinition__c.ffr__Title__c}</h1></td>
<td align="right">{!NOW()}</td>
</tr>
<tr><td class="ffrgridspacer2"></td></tr>
<tr>
<td><h1 class="ffrname">{!ffr__ReportingDefinition__c.Name}</h1></td>
<td align="right"><h2 class="ffrwhiteonwhite">{!ffr__ReportingDefinition__c.ffr__ReportingTemplate__c}</h2></td>
</tr>
<tr><td class="ffrgridspacer2"></td></tr>
<tr>
<td align="left">{!ffr__ReportingDefinition__c.ffr__Description__c}</td>
<td align="right"><h2 class="ffrwhiteonwhite">{!ffr__ReportingDefinition__c.ffr__StyleSheet__c}</h2></td>
</tr>
</table>
<!-- User Note: Create a new table to display the prompt information -->
<table class="ffrgridnotfullpage">
<tr><td class="ffrgridspacer2"></td></tr>
<tr>
<td align="left">
<table class="ffrgrid">
<apex:repeat value="{!promptList}" var="prompt" >
<tr>
<td align="left">{!prompt.label}</td>
<td align="left" class="ffrgridspacer"></td>
<td align="left"><strong>{!prompt.value}</strong></td>
</tr>
</apex:repeat>
</table>
</td>
</tr>
</table>
<!-- User Note: Insert a space after the header -->
<table class="ffrgrid">
<tr><td class="ffrgridspacer"></td></tr>
</table>
<!-- REGION 02: REPORT HEADER END -->
<!-- REGION 03: REPORT BODY START -->
<apex:outputpanel rendered="{!!hasMessages}">
    <!-- This template uses only one data range -->
    <apex:variable var="dataRange" value="{!reportingData['DR01']}"/>
    <!-- Configuration of columns and groups (elastic template responds dynamically to existence of groups and columns -->
    <!-- Column setup -->
    <!-- Set the default column rendering state variables to "false" -->
    <apex:variable var="RenderColumnA" value="{!false}"/>
    <apex:variable var="RenderColumnB" value="{!false}"/>
    <apex:variable var="RenderColumnC" value="{!false}"/>
    <apex:variable var="RenderColumnD" value="{!false}"/>
    <apex:variable var="RenderColumnE" value="{!false}"/>
    <apex:variable var="RenderColumnF" value="{!false}"/>
    <apex:variable var="RenderColumnG" value="{!false}"/>
    <apex:variable var="RenderColumnH" value="{!false}"/>
    <apex:variable var="RenderColumnI" value="{!false}"/>
    <apex:variable var="RenderColumnJ" value="{!false}"/>
    <apex:variable var="RenderColumnK" value="{!false}"/>
    <apex:variable var="RenderColumnL" value="{!false}"/>
    <apex:variable var="RenderColumnM" value="{!false}"/>
    <apex:variable var="RenderColumnN" value="{!false}"/>
    <apex:variable var="RenderColumnO" value="{!false}"/>
    <apex:variable var="RenderColumnP" value="{!false}"/>
    <apex:variable var="RenderColumnQ" value="{!false}"/>
    <apex:variable var="RenderColumnR" value="{!false}"/>
    <apex:variable var="RenderColumnS" value="{!false}"/>
    <apex:variable var="RenderColumnT" value="{!false}"/>
    <apex:variable var="RenderColumnU" value="{!false}"/>
    <apex:variable var="RenderColumnV" value="{!false}"/>
    <apex:variable var="RenderColumnW" value="{!false}"/>
    <apex:variable var="RenderColumnX" value="{!false}"/>
    <apex:variable var="RenderColumnY" value="{!false}"/>
    <apex:variable var="RenderColumnZ" value="{!false}"/>
    <apex:variable var="RenderAnyColumn" value="{!false}"/>
    <!-- Set the default column rendering state for calculated columns -->
    <!-- Now set the column rendering state variables according to which columns have been used (via column filter mappings) -->
    <apex:repeat var="columnKey" value="{!dataRange.columnKeyList}">
        <apex:variable var="RenderColumnA" value="{!true}" rendered="{!columnKey=='A'}" />
        <apex:variable var="RenderColumnB" value="{!true}" rendered="{!columnKey=='B'}" />
        <apex:variable var="RenderColumnC" value="{!true}" rendered="{!columnKey=='C'}" />
        <apex:variable var="RenderColumnD" value="{!true}" rendered="{!columnKey=='D'}" />
        <apex:variable var="RenderColumnE" value="{!true}" rendered="{!columnKey=='E'}" />
        <apex:variable var="RenderColumnF" value="{!true}" rendered="{!columnKey=='F'}" />
        <apex:variable var="RenderColumnG" value="{!true}" rendered="{!columnKey=='G'}" />
        <apex:variable var="RenderColumnH" value="{!true}" rendered="{!columnKey=='H'}" />
        <apex:variable var="RenderColumnI" value="{!true}" rendered="{!columnKey=='I'}" />
        <apex:variable var="RenderColumnJ" value="{!true}" rendered="{!columnKey=='J'}" />
        <apex:variable var="RenderColumnK" value="{!true}" rendered="{!columnKey=='K'}" />
        <apex:variable var="RenderColumnL" value="{!true}" rendered="{!columnKey=='L'}" />
        <apex:variable var="RenderColumnM" value="{!true}" rendered="{!columnKey=='M'}" />
        <apex:variable var="RenderColumnN" value="{!true}" rendered="{!columnKey=='N'}" />
        <apex:variable var="RenderColumnO" value="{!true}" rendered="{!columnKey=='O'}" />
        <apex:variable var="RenderColumnP" value="{!true}" rendered="{!columnKey=='P'}" />
        <apex:variable var="RenderColumnQ" value="{!true}" rendered="{!columnKey=='Q'}" />
        <apex:variable var="RenderColumnR" value="{!true}" rendered="{!columnKey=='R'}" />
        <apex:variable var="RenderColumnS" value="{!true}" rendered="{!columnKey=='S'}" />
        <apex:variable var="RenderColumnT" value="{!true}" rendered="{!columnKey=='T'}" />
        <apex:variable var="RenderColumnU" value="{!true}" rendered="{!columnKey=='U'}" />
        <apex:variable var="RenderColumnV" value="{!true}" rendered="{!columnKey=='V'}" />
        <apex:variable var="RenderColumnW" value="{!true}" rendered="{!columnKey=='W'}" />
        <apex:variable var="RenderColumnX" value="{!true}" rendered="{!columnKey=='X'}" />
        <apex:variable var="RenderColumnY" value="{!true}" rendered="{!columnKey=='Y'}" />
        <apex:variable var="RenderColumnZ" value="{!true}" rendered="{!columnKey=='Z'}" />
        <apex:variable var="RenderAnyColumn" value="{!true}" rendered="{!(columnKey=='A' || columnKey=='B' || columnKey=='C' || columnKey=='D' || columnKey=='E' || columnKey=='F' || columnKey=='G' || columnKey=='H' || columnKey=='I' || columnKey=='J' || columnKey=='K' || columnKey=='L' || columnKey=='M' || columnKey=='N' || columnKey=='O' || columnKey=='P' || columnKey=='Q' || columnKey=='R' || columnKey=='S' || columnKey=='T' || columnKey=='U' || columnKey=='V' || columnKey=='W' || columnKey=='X' || columnKey=='Y' || columnKey=='Z')}" />
    </apex:repeat>
    <!-- Group setup-->
    <!-- Set the default group value rendering state variables to "false" -->
    <apex:variable var="RenderGroup01" value="{!false}"/>
    <apex:variable var="RenderGroup02" value="{!false}"/>
    <apex:variable var="RenderGroup03" value="{!false}"/>
    <apex:variable var="RenderGroup04" value="{!false}"/>
    <apex:variable var="RenderGroup05" value="{!false}"/>
    <apex:variable var="RenderGroup10" value="{!false}"/>
    <apex:variable var="RenderGroup11" value="{!false}"/>
    <apex:variable var="RenderGroup12" value="{!false}"/>
    <apex:variable var="RenderGroup13" value="{!false}"/>
    <apex:variable var="RenderGroup14" value="{!false}"/>
    <apex:variable var="RenderGroup15" value="{!false}"/>
    <apex:variable var="RenderGroup16" value="{!false}"/>
    <apex:variable var="RenderGroup17" value="{!false}"/>
    <apex:variable var="RenderGroup18" value="{!false}"/>
    <apex:variable var="RenderGroup19" value="{!false}"/>
    <apex:variable var="RenderGroup20" value="{!false}"/>
    <!-- In some places we want to span the groups with a single label, so to do this we need to know how many groups we will render -->
    <apex:variable var="countRenderedGroups" value="{!0}"/>
    <!-- We need to know whether to keep group subtotals. Default condition is false -->
    <apex:variable var="RenderGroupSubtotals" value="{!false}"/>
    <!-- Now set the group rendering state variables according to which group values have been used, and count them -->
    <!-- Additionally, if we have any of groups 01-09 we need to maintain group subtotals -->
    <apex:repeat var="groupKey" value="{!dataRange.groupKeyList}">
    <!-- Group-groups -->
    <apex:outputPanel layout="none" rendered="{!groupKey=='01'}">
    <apex:variable var="RenderGroup01" value="{!true}"/>
    <apex:variable var="countRenderedGroups" value="{!countRenderedGroups+1}"/>
    <apex:variable var="RenderGroupSubtotals" value="{!true}"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!groupKey=='02'}">
    <apex:variable var="RenderGroup02" value="{!true}"/>
    <apex:variable var="countRenderedGroups" value="{!countRenderedGroups+1}"/>
    <apex:variable var="RenderGroupSubtotals" value="{!true}"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!groupKey=='03'}">
    <apex:variable var="RenderGroup03" value="{!true}"/>
    <apex:variable var="countRenderedGroups" value="{!countRenderedGroups+1}"/>
    <apex:variable var="RenderGroupSubtotals" value="{!true}"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!groupKey=='04'}">
    <apex:variable var="RenderGroup04" value="{!true}"/>
    <apex:variable var="countRenderedGroups" value="{!countRenderedGroups+1}"/>
    <apex:variable var="RenderGroupSubtotals" value="{!true}"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!groupKey=='05'}">
    <apex:variable var="RenderGroup05" value="{!true}"/>
    <apex:variable var="countRenderedGroups" value="{!countRenderedGroups+1}"/>
    <apex:variable var="RenderGroupSubtotals" value="{!true}"/>
    </apex:outputPanel>
    <!-- Line-groups -->
    <apex:outputPanel layout="none" rendered="{!groupKey=='10'}">
    <apex:variable var="RenderGroup10" value="{!true}"/>
    <apex:variable var="countRenderedGroups" value="{!countRenderedGroups+1}"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!groupKey=='11'}">
    <apex:variable var="RenderGroup11" value="{!true}"/>
    <apex:variable var="countRenderedGroups" value="{!countRenderedGroups+1}"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!groupKey=='12'}">
    <apex:variable var="RenderGroup12" value="{!true}"/>
    <apex:variable var="countRenderedGroups" value="{!countRenderedGroups+1}"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!groupKey=='13'}">
    <apex:variable var="RenderGroup13" value="{!true}"/>
    <apex:variable var="countRenderedGroups" value="{!countRenderedGroups+1}"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!groupKey=='14'}">
    <apex:variable var="RenderGroup14" value="{!true}"/>
    <apex:variable var="countRenderedGroups" value="{!countRenderedGroups+1}"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!groupKey=='15'}">
    <apex:variable var="RenderGroup15" value="{!true}"/>
    <apex:variable var="countRenderedGroups" value="{!countRenderedGroups+1}"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!groupKey=='16'}">
    <apex:variable var="RenderGroup16" value="{!true}"/>
    <apex:variable var="countRenderedGroups" value="{!countRenderedGroups+1}"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!groupKey=='17'}">
    <apex:variable var="RenderGroup17" value="{!true}"/>
    <apex:variable var="countRenderedGroups" value="{!countRenderedGroups+1}"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!groupKey=='18'}">
    <apex:variable var="RenderGroup18" value="{!true}"/>
    <apex:variable var="countRenderedGroups" value="{!countRenderedGroups+1}"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!groupKey=='19'}">
    <apex:variable var="RenderGroup19" value="{!true}"/>
    <apex:variable var="countRenderedGroups" value="{!countRenderedGroups+1}"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!groupKey=='20'}">
    <apex:variable var="RenderGroup20" value="{!true}"/>
    <apex:variable var="countRenderedGroups" value="{!countRenderedGroups+1}"/>
    </apex:outputPanel>
    </apex:repeat>

    <table class="ffrgrid">
    <tr>
    <!-- Column headings -->
    <!-- Note that these are contained within outputPanels which are rendered (displayed) depending on the appropriate column render state variable -->
    <!-- Groups 1-9 are groups with sub-totals (groups), 10- are groups without sub-totals (lines) -->
    <th class="{!if(RenderGroup01,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup01}">{!dataRange.groupLabels['01']}</apex:outputPanel></th>
    <th class="{!if(RenderGroup02,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup02}">{!dataRange.groupLabels['02']}</apex:outputPanel></th>
    <th class="{!if(RenderGroup03,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup03}">{!dataRange.groupLabels['03']}</apex:outputPanel></th>
    <th class="{!if(RenderGroup04,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup04}">{!dataRange.groupLabels['04']}</apex:outputPanel></th>
    <th class="{!if(RenderGroup05,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup05}">{!dataRange.groupLabels['05']}</apex:outputPanel></th>
    <th class="{!if(RenderGroup10,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup10}">{!dataRange.groupLabels['10']}</apex:outputPanel></th>
    <th class="{!if(RenderGroup11,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup11}">{!dataRange.groupLabels['11']}</apex:outputPanel></th>
    <th class="{!if(RenderGroup12,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup12}">{!dataRange.groupLabels['12']}</apex:outputPanel></th>
    <th class="{!if(RenderGroup13,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup13}">{!dataRange.groupLabels['13']}</apex:outputPanel></th>
    <th class="{!if(RenderGroup14,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup14}">{!dataRange.groupLabels['14']}</apex:outputPanel></th>
    <th class="{!if(RenderGroup15,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup15}">{!dataRange.groupLabels['15']}</apex:outputPanel></th>
    <th class="{!if(RenderGroup16,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup16}">{!dataRange.groupLabels['16']}</apex:outputPanel></th>
    <th class="{!if(RenderGroup17,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup17}">{!dataRange.groupLabels['17']}</apex:outputPanel></th>
    <th class="{!if(RenderGroup18,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup18}">{!dataRange.groupLabels['18']}</apex:outputPanel></th>
    <th class="{!if(RenderGroup19,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup19}">{!dataRange.groupLabels['19']}</apex:outputPanel></th>
    <th class="{!if(RenderGroup20,'ffrgridtitleleftd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup20}">{!dataRange.groupLabels['20']}</apex:outputPanel></th>
    <td class="ffrgridspacer"/>
    <!-- Column Headings for the first Sum Type Reporting Values (Value = A) -->
    <th class="{!if(RenderColumnA,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnA}">{!dataRange.columnLabels['A']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnB,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnB}">{!dataRange.columnLabels['B']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnC,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnC}">{!dataRange.columnLabels['C']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnD,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnD}">{!dataRange.columnLabels['D']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnE,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnE}">{!dataRange.columnLabels['E']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnF,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnF}">{!dataRange.columnLabels['F']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnG,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnG}">{!dataRange.columnLabels['G']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnH,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnH}">{!dataRange.columnLabels['H']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnI,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnI}">{!dataRange.columnLabels['I']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnJ,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnJ}">{!dataRange.columnLabels['J']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnK,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnK}">{!dataRange.columnLabels['K']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnL,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnL}">{!dataRange.columnLabels['L']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnM,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnM}">{!dataRange.columnLabels['M']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnN,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnN}">{!dataRange.columnLabels['N']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnO,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnO}">{!dataRange.columnLabels['O']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnP,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnP}">{!dataRange.columnLabels['P']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnQ,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnQ}">{!dataRange.columnLabels['Q']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnR,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnR}">{!dataRange.columnLabels['R']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnS,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnS}">{!dataRange.columnLabels['S']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnT,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnT}">{!dataRange.columnLabels['T']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnU,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnU}">{!dataRange.columnLabels['U']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnV,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnV}">{!dataRange.columnLabels['V']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnW,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnW}">{!dataRange.columnLabels['W']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnX,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnX}">{!dataRange.columnLabels['X']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnY,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnY}">{!dataRange.columnLabels['Y']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnZ,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnZ}">{!dataRange.columnLabels['Z']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <td class="ffrgridspacer"/>
    <th class="{!if(RenderAnyColumn,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderAnyColumn}">{!label['L45']}<br/>{!dataRange.valueLabels['A']}</apex:outputPanel></th>
    <td class="ffrgridspacer"/>
    <!-- Column Headings for the second Sum Type Reporting Values (Value = B) -->
    <th class="{!if(RenderColumnA,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnA}">{!dataRange.columnLabels['A']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnB,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnB}">{!dataRange.columnLabels['B']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnC,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnC}">{!dataRange.columnLabels['C']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnD,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnD}">{!dataRange.columnLabels['D']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnE,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnE}">{!dataRange.columnLabels['E']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnF,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnF}">{!dataRange.columnLabels['F']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnG,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnG}">{!dataRange.columnLabels['G']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnH,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnH}">{!dataRange.columnLabels['H']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnI,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnI}">{!dataRange.columnLabels['I']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnJ,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnJ}">{!dataRange.columnLabels['J']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnK,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnK}">{!dataRange.columnLabels['K']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnL,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnL}">{!dataRange.columnLabels['L']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnM,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnM}">{!dataRange.columnLabels['M']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnN,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnN}">{!dataRange.columnLabels['N']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnO,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnO}">{!dataRange.columnLabels['O']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnP,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnP}">{!dataRange.columnLabels['P']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnQ,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnQ}">{!dataRange.columnLabels['Q']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnR,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnR}">{!dataRange.columnLabels['R']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnS,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnS}">{!dataRange.columnLabels['S']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnT,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnT}">{!dataRange.columnLabels['T']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnU,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnU}">{!dataRange.columnLabels['U']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnV,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnV}">{!dataRange.columnLabels['V']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnW,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnW}">{!dataRange.columnLabels['W']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnX,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnX}">{!dataRange.columnLabels['X']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnY,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnY}">{!dataRange.columnLabels['Y']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <th class="{!if(RenderColumnZ,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnZ}">{!dataRange.columnLabels['Z']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    <td class="ffrgridspacer"/>
    <th class="{!if(RenderAnyColumn,'ffrgridtitlerightd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderAnyColumn}">{!label['L45']}<br/>{!dataRange.valueLabels['B']}</apex:outputPanel></th>
    </tr>
    <!-- Set all column grand-totals to zero (if the column is in use - determined by column render state variables) -->
    <tr><td class = "ffrhidden">
    <!-- Grand Totals for Sum Value A -->
    <apex:variable value="{!0}" var="grandTotalAColumnA" rendered="{!RenderColumnA}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnB" rendered="{!RenderColumnB}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnC" rendered="{!RenderColumnC}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnD" rendered="{!RenderColumnD}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnE" rendered="{!RenderColumnE}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnF" rendered="{!RenderColumnF}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnG" rendered="{!RenderColumnG}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnH" rendered="{!RenderColumnH}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnI" rendered="{!RenderColumnI}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnJ" rendered="{!RenderColumnJ}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnK" rendered="{!RenderColumnK}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnL" rendered="{!RenderColumnL}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnM" rendered="{!RenderColumnM}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnN" rendered="{!RenderColumnN}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnO" rendered="{!RenderColumnO}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnP" rendered="{!RenderColumnP}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnQ" rendered="{!RenderColumnQ}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnR" rendered="{!RenderColumnR}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnS" rendered="{!RenderColumnS}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnT" rendered="{!RenderColumnT}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnU" rendered="{!RenderColumnU}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnV" rendered="{!RenderColumnV}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnW" rendered="{!RenderColumnW}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnX" rendered="{!RenderColumnX}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnY" rendered="{!RenderColumnY}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnZ" rendered="{!RenderColumnZ}"/>
    <apex:variable value="{!0}" var="grandTotalAColumnAll" rendered="{!RenderAnyColumn}"/>
    <!-- Grand Totals for Sum Value B -->
    <apex:variable value="{!0}" var="grandTotalBColumnA" rendered="{!RenderColumnA}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnB" rendered="{!RenderColumnB}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnC" rendered="{!RenderColumnC}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnD" rendered="{!RenderColumnD}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnE" rendered="{!RenderColumnE}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnF" rendered="{!RenderColumnF}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnG" rendered="{!RenderColumnG}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnH" rendered="{!RenderColumnH}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnI" rendered="{!RenderColumnI}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnJ" rendered="{!RenderColumnJ}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnK" rendered="{!RenderColumnK}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnL" rendered="{!RenderColumnL}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnM" rendered="{!RenderColumnM}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnN" rendered="{!RenderColumnN}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnO" rendered="{!RenderColumnO}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnP" rendered="{!RenderColumnP}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnQ" rendered="{!RenderColumnQ}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnR" rendered="{!RenderColumnR}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnS" rendered="{!RenderColumnS}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnT" rendered="{!RenderColumnT}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnU" rendered="{!RenderColumnU}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnV" rendered="{!RenderColumnV}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnW" rendered="{!RenderColumnW}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnX" rendered="{!RenderColumnX}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnY" rendered="{!RenderColumnY}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnZ" rendered="{!RenderColumnZ}"/>
    <apex:variable value="{!0}" var="grandTotalBColumnAll" rendered="{!RenderAnyColumn}"/>
    <!-- We need to track Sales Revenue for Sum Values A -->
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnA" rendered="{!RenderColumnA}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnB" rendered="{!RenderColumnB}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnC" rendered="{!RenderColumnC}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnD" rendered="{!RenderColumnD}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnE" rendered="{!RenderColumnE}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnF" rendered="{!RenderColumnF}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnG" rendered="{!RenderColumnG}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnH" rendered="{!RenderColumnH}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnI" rendered="{!RenderColumnI}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnJ" rendered="{!RenderColumnJ}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnK" rendered="{!RenderColumnK}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnL" rendered="{!RenderColumnL}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnM" rendered="{!RenderColumnM}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnN" rendered="{!RenderColumnN}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnO" rendered="{!RenderColumnO}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnP" rendered="{!RenderColumnP}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnQ" rendered="{!RenderColumnQ}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnR" rendered="{!RenderColumnR}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnS" rendered="{!RenderColumnS}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnT" rendered="{!RenderColumnT}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnU" rendered="{!RenderColumnU}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnV" rendered="{!RenderColumnV}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnW" rendered="{!RenderColumnW}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnX" rendered="{!RenderColumnX}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnY" rendered="{!RenderColumnY}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnZ" rendered="{!RenderColumnZ}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalAColumnAll" rendered="{!RenderAnyColumn}"/>
    <!-- We need to track Sales Revenue for Sum Values B -->
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnA" rendered="{!RenderColumnA}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnB" rendered="{!RenderColumnB}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnC" rendered="{!RenderColumnC}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnD" rendered="{!RenderColumnD}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnE" rendered="{!RenderColumnE}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnF" rendered="{!RenderColumnF}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnG" rendered="{!RenderColumnG}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnH" rendered="{!RenderColumnH}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnI" rendered="{!RenderColumnI}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnJ" rendered="{!RenderColumnJ}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnK" rendered="{!RenderColumnK}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnL" rendered="{!RenderColumnL}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnM" rendered="{!RenderColumnM}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnN" rendered="{!RenderColumnN}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnO" rendered="{!RenderColumnO}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnP" rendered="{!RenderColumnP}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnQ" rendered="{!RenderColumnQ}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnR" rendered="{!RenderColumnR}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnS" rendered="{!RenderColumnS}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnT" rendered="{!RenderColumnT}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnU" rendered="{!RenderColumnU}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnV" rendered="{!RenderColumnV}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnW" rendered="{!RenderColumnW}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnX" rendered="{!RenderColumnX}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnY" rendered="{!RenderColumnY}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnZ" rendered="{!RenderColumnZ}"/>
    <apex:variable value="{!0}" var="salesRevenueTotalBColumnAll" rendered="{!RenderAnyColumn}"/>
    </td></tr>
    <!-- We need to track whether or not the Gross Margin calculations have been displayed - this defaults to false -->
    <apex:variable value="{!false}" var="GrossMarginCalculationsDisplayed"/>
    <!-- Iterate over the Rows -->
    <apex:repeat value="{!dataRange.rowList}" var="row" >
    <!-- Setup for start of row -->
    <apex:variable var="rowKeyNum" value="{!0}"/>
    <tr><td class = "ffrhidden">
    <c:ToNumber value="{!row.key}" convertedVarName="rowKeyNum"/>
    <!-- Row-sensitive number format -->
    <apex:variable var="RowNumberPattern" value="{!if(rowKeyNum>10 && rowKeyNum<61,VN,VR)}"/>
    </td></tr>
    <!-- Display the Gross Margin calculations if they have not been displayed and all the Gross Margins rows have been processed -->
    <apex:outputPanel layout="none" rendered="{!!GrossMarginCalculationsDisplayed && rowKeyNum>20}">
    <!-- Display Gross Margin -->
    <tr>
        <td class="ffrcalcsumlabeld" colspan="16">{!label['L10']}</td>
    <td class="ffrgridspacerd"/>
    <!-- Gross Margin for Sum Values A -->
        <th class="{!if(RenderColumnA,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnA}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnA}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnB,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnB}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnB}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnC,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnC}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnC}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnD,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnD}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnD}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnE,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnE}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnE}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnF,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnF}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnF}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnG,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnG}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnG}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnH,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnH}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnH}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnI,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnI}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnI}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnJ,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnJ}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnJ}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnK,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnK}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnK}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnL,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnL}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnL}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnM,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnM}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnM}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnN,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnN}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnN}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnO,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnO}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnO}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnP,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnP}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnP}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnQ,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnQ}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnQ}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnR,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnR}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnR}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnS,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnS}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnS}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnT,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnT}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnT}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnU,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnU}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnU}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnV,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnV}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnV}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnW,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnW}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnW}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnX,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnX}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnX}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnY,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnY}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnY}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnZ,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnZ}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnZ}"/></apex:outputPanel></th>
    <td class="ffrgridspacerd"/>
        <th class="{!if(RenderAnyColumn,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderAnyColumn}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnAll}"/></apex:outputPanel></th>
    <td class="ffrgridspacer"/>
    <!-- Gross Margin for Sum Values B -->
        <th class="{!if(RenderColumnA,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnA}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnA}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnB,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnB}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnB}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnC,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnC}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnC}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnD,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnD}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnD}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnE,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnE}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnE}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnF,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnF}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnF}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnG,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnG}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnG}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnH,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnH}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnH}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnI,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnI}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnI}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnJ,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnJ}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnJ}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnK,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnK}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnK}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnL,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnL}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnL}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnM,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnM}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnM}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnN,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnN}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnN}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnO,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnO}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnO}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnP,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnP}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnP}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnQ,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnQ}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnQ}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnR,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnR}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnR}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnS,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnS}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnS}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnT,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnT}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnT}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnU,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnU}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnU}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnV,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnV}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnV}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnW,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnW}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnW}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnX,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnX}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnX}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnY,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnY}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnY}"/></apex:outputPanel></th>
        <th class="{!if(RenderColumnZ,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnZ}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnZ}"/></apex:outputPanel></th>
    <td class="ffrgridspacerd"/>
        <th class="{!if(RenderAnyColumn,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderAnyColumn}"><c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnAll}"/></apex:outputPanel></th>
    </tr>
    <!-- Spacer -->
    <tr><td class="ffrgridspacerd" colspan="16"></td></tr>
    <!-- Display Gross Margin % -->
    <tr>
    <td class="ffrcalcsumlabeld" colspan="16">{!label['L11']}</td>
    <td class="ffrgridspacerd"/>
    <!-- Gross Margin % for Sum Values A -->
    <th class="{!if(RenderColumnA,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnA}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnA=0,0,grandTotalAColumnA/salesRevenueTotalAColumnA)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnB,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnB}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnB=0,0,grandTotalAColumnB/salesRevenueTotalAColumnB)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnC,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnC}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnC=0,0,grandTotalAColumnC/salesRevenueTotalAColumnC)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnD,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnD}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnD=0,0,grandTotalAColumnD/salesRevenueTotalAColumnD)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnE,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnE}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnE=0,0,grandTotalAColumnE/salesRevenueTotalAColumnE)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnF,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnF}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnF=0,0,grandTotalAColumnF/salesRevenueTotalAColumnF)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnG,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnG}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnG=0,0,grandTotalAColumnG/salesRevenueTotalAColumnG)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnH,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnH}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnH=0,0,grandTotalAColumnH/salesRevenueTotalAColumnH)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnI,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnI}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnI=0,0,grandTotalAColumnI/salesRevenueTotalAColumnI)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnJ,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnJ}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnJ=0,0,grandTotalAColumnJ/salesRevenueTotalAColumnJ)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnK,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnK}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnK=0,0,grandTotalAColumnK/salesRevenueTotalAColumnK)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnL,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnL}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnL=0,0,grandTotalAColumnL/salesRevenueTotalAColumnL)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnM,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnM}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnM=0,0,grandTotalAColumnM/salesRevenueTotalAColumnM)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnN,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnN}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnN=0,0,grandTotalAColumnN/salesRevenueTotalAColumnN)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnO,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnO}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnO=0,0,grandTotalAColumnO/salesRevenueTotalAColumnO)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnP,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnP}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnP=0,0,grandTotalAColumnP/salesRevenueTotalAColumnP)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnQ,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnQ}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnQ=0,0,grandTotalAColumnQ/salesRevenueTotalAColumnQ)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnR,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnR}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnR=0,0,grandTotalAColumnR/salesRevenueTotalAColumnR)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnS,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnS}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnS=0,0,grandTotalAColumnS/salesRevenueTotalAColumnS)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnT,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnT}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnT=0,0,grandTotalAColumnT/salesRevenueTotalAColumnT)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnU,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnU}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnU=0,0,grandTotalAColumnU/salesRevenueTotalAColumnU)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnV,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnV}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnV=0,0,grandTotalAColumnV/salesRevenueTotalAColumnV)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnW,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnW}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnW=0,0,grandTotalAColumnW/salesRevenueTotalAColumnW)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnX,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnX}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnX=0,0,grandTotalAColumnX/salesRevenueTotalAColumnX)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnY,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnY}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnY=0,0,grandTotalAColumnY/salesRevenueTotalAColumnY)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnZ,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnZ}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnZ=0,0,grandTotalAColumnZ/salesRevenueTotalAColumnZ)}"/></apex:outputPanel></th>
    <td class="ffrgridspacerd"/>
    <th class="{!if(RenderAnyColumn,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderAnyColumn}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnAll=0,0,grandTotalAColumnAll/salesRevenueTotalAColumnAll)}"/></apex:outputPanel></th>
    <td class="ffrgridspacer"/>
    <!-- Gross Margin % for Sum Values B -->
    <th class="{!if(RenderColumnA,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnA}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnA=0,0,grandTotalBColumnA/salesRevenueTotalBColumnA)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnB,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnB}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnB=0,0,grandTotalBColumnB/salesRevenueTotalBColumnB)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnC,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnC}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnC=0,0,grandTotalBColumnC/salesRevenueTotalBColumnC)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnD,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnD}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnD=0,0,grandTotalBColumnD/salesRevenueTotalBColumnD)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnE,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnE}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnE=0,0,grandTotalBColumnE/salesRevenueTotalBColumnE)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnF,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnF}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnF=0,0,grandTotalBColumnF/salesRevenueTotalBColumnF)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnG,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnG}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnG=0,0,grandTotalBColumnG/salesRevenueTotalBColumnG)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnH,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnH}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnH=0,0,grandTotalBColumnH/salesRevenueTotalBColumnH)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnI,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnI}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnI=0,0,grandTotalBColumnI/salesRevenueTotalBColumnI)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnJ,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnJ}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnJ=0,0,grandTotalBColumnJ/salesRevenueTotalBColumnJ)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnK,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnK}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnK=0,0,grandTotalBColumnK/salesRevenueTotalBColumnK)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnL,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnL}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnL=0,0,grandTotalBColumnL/salesRevenueTotalBColumnL)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnM,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnM}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnM=0,0,grandTotalBColumnM/salesRevenueTotalBColumnM)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnN,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnN}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnN=0,0,grandTotalBColumnN/salesRevenueTotalBColumnN)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnO,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnO}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnO=0,0,grandTotalBColumnO/salesRevenueTotalBColumnO)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnP,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnP}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnP=0,0,grandTotalBColumnP/salesRevenueTotalBColumnP)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnQ,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnQ}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnQ=0,0,grandTotalBColumnQ/salesRevenueTotalBColumnQ)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnR,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnR}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnR=0,0,grandTotalBColumnR/salesRevenueTotalBColumnR)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnS,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnS}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnS=0,0,grandTotalBColumnS/salesRevenueTotalBColumnS)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnT,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnT}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnT=0,0,grandTotalBColumnT/salesRevenueTotalBColumnT)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnU,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnU}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnU=0,0,grandTotalBColumnU/salesRevenueTotalBColumnU)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnV,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnV}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnV=0,0,grandTotalBColumnV/salesRevenueTotalBColumnV)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnW,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnW}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnW=0,0,grandTotalBColumnW/salesRevenueTotalBColumnW)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnX,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnX}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnX=0,0,grandTotalBColumnX/salesRevenueTotalBColumnX)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnY,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnY}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnY=0,0,grandTotalBColumnY/salesRevenueTotalBColumnY)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnZ,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnZ}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnZ=0,0,grandTotalBColumnZ/salesRevenueTotalBColumnZ)}"/></apex:outputPanel></th>
    <td class="ffrgridspacerd"/>
    <th class="{!if(RenderAnyColumn,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderAnyColumn}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnAll=0,0,grandTotalBColumnAll/salesRevenueTotalBColumnAll)}"/></apex:outputPanel></th>
    </tr>
    <!-- Spacer -->
    <tr><td class="ffrgridspacerd" colspan="16"></td></tr>
    <!-- Set the flag to indicate that we have displayed Gross Margin calculations -->
    <apex:variable value="{!true}" var="GrossMarginCalculationsDisplayed"/>
    </apex:outputPanel>
    <!-- For each row, reset all column row-totals and subtotals to zero (if the column is in use - determined by column render state variables) -->
    <tr><td class = "ffrhidden">
    <!-- Row Totals and Subtotals for Sum Values A -->
    <apex:variable value="{!0}" var="rowTotalAColumnA" rendered="{!RenderColumnA}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnB" rendered="{!RenderColumnB}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnC" rendered="{!RenderColumnC}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnD" rendered="{!RenderColumnD}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnE" rendered="{!RenderColumnE}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnF" rendered="{!RenderColumnF}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnG" rendered="{!RenderColumnG}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnH" rendered="{!RenderColumnH}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnI" rendered="{!RenderColumnI}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnJ" rendered="{!RenderColumnJ}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnK" rendered="{!RenderColumnK}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnL" rendered="{!RenderColumnL}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnM" rendered="{!RenderColumnM}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnN" rendered="{!RenderColumnN}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnO" rendered="{!RenderColumnO}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnP" rendered="{!RenderColumnP}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnQ" rendered="{!RenderColumnQ}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnR" rendered="{!RenderColumnR}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnS" rendered="{!RenderColumnS}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnT" rendered="{!RenderColumnT}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnU" rendered="{!RenderColumnU}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnV" rendered="{!RenderColumnV}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnW" rendered="{!RenderColumnW}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnX" rendered="{!RenderColumnX}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnY" rendered="{!RenderColumnY}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnZ" rendered="{!RenderColumnZ}"/>
    <apex:variable value="{!0}" var="rowTotalAColumnAll" rendered="{!RenderAnyColumn}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnA" rendered="{!RenderColumnA}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnB" rendered="{!RenderColumnB}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnC" rendered="{!RenderColumnC}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnD" rendered="{!RenderColumnD}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnE" rendered="{!RenderColumnE}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnF" rendered="{!RenderColumnF}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnG" rendered="{!RenderColumnG}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnH" rendered="{!RenderColumnH}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnI" rendered="{!RenderColumnI}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnJ" rendered="{!RenderColumnJ}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnK" rendered="{!RenderColumnK}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnL" rendered="{!RenderColumnL}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnM" rendered="{!RenderColumnM}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnN" rendered="{!RenderColumnN}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnO" rendered="{!RenderColumnO}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnP" rendered="{!RenderColumnP}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnQ" rendered="{!RenderColumnQ}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnR" rendered="{!RenderColumnR}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnS" rendered="{!RenderColumnS}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnT" rendered="{!RenderColumnT}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnU" rendered="{!RenderColumnU}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnV" rendered="{!RenderColumnV}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnW" rendered="{!RenderColumnW}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnX" rendered="{!RenderColumnX}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnY" rendered="{!RenderColumnY}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnZ" rendered="{!RenderColumnZ}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnAll" rendered="{!RenderAnyColumn}"/>
    <!-- Row Totals and Subtotals for Sum Values B -->
    <apex:variable value="{!0}" var="rowTotalBColumnA" rendered="{!RenderColumnA}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnB" rendered="{!RenderColumnB}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnC" rendered="{!RenderColumnC}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnD" rendered="{!RenderColumnD}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnE" rendered="{!RenderColumnE}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnF" rendered="{!RenderColumnF}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnG" rendered="{!RenderColumnG}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnH" rendered="{!RenderColumnH}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnI" rendered="{!RenderColumnI}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnJ" rendered="{!RenderColumnJ}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnK" rendered="{!RenderColumnK}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnL" rendered="{!RenderColumnL}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnM" rendered="{!RenderColumnM}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnN" rendered="{!RenderColumnN}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnO" rendered="{!RenderColumnO}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnP" rendered="{!RenderColumnP}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnQ" rendered="{!RenderColumnQ}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnR" rendered="{!RenderColumnR}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnS" rendered="{!RenderColumnS}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnT" rendered="{!RenderColumnT}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnU" rendered="{!RenderColumnU}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnV" rendered="{!RenderColumnV}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnW" rendered="{!RenderColumnW}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnX" rendered="{!RenderColumnX}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnY" rendered="{!RenderColumnY}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnZ" rendered="{!RenderColumnZ}"/>
    <apex:variable value="{!0}" var="rowTotalBColumnAll" rendered="{!RenderAnyColumn}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnA" rendered="{!RenderColumnA}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnB" rendered="{!RenderColumnB}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnC" rendered="{!RenderColumnC}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnD" rendered="{!RenderColumnD}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnE" rendered="{!RenderColumnE}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnF" rendered="{!RenderColumnF}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnG" rendered="{!RenderColumnG}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnH" rendered="{!RenderColumnH}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnI" rendered="{!RenderColumnI}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnJ" rendered="{!RenderColumnJ}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnK" rendered="{!RenderColumnK}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnL" rendered="{!RenderColumnL}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnM" rendered="{!RenderColumnM}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnN" rendered="{!RenderColumnN}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnO" rendered="{!RenderColumnO}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnP" rendered="{!RenderColumnP}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnQ" rendered="{!RenderColumnQ}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnR" rendered="{!RenderColumnR}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnS" rendered="{!RenderColumnS}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnT" rendered="{!RenderColumnT}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnU" rendered="{!RenderColumnU}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnV" rendered="{!RenderColumnV}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnW" rendered="{!RenderColumnW}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnX" rendered="{!RenderColumnX}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnY" rendered="{!RenderColumnY}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnZ" rendered="{!RenderColumnZ}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnAll" rendered="{!RenderAnyColumn}"/>
    </td></tr>
    <!-- These variables are used to determine when to print a subtotal -->
    <apex:variable var="previousLineGroup01" value=""/>
    <apex:variable var="previousLineGroup02" value=""/>
    <apex:variable var="previousLineGroup03" value=""/>
    <apex:variable var="previousLineGroup04" value=""/>
    <apex:variable var="previousLineGroup05" value=""/>
    <apex:variable var="currentLineGroup01" value=""/>
    <apex:variable var="currentLineGroup02" value=""/>
    <apex:variable var="currentLineGroup03" value=""/>
    <apex:variable var="currentLineGroup04" value=""/>
    <apex:variable var="currentLineGroup05" value=""/>
    <!-- This variable is used to determine whether the line is the first line in the row - to prevent a subtotal being printed before the first line -->
    <apex:variable var="firstLine" value="{!true}"/>
    <!-- Iterate over the Lines -->
    <apex:repeat value="{!row.lineList}" var="line" >
    <!-- Display the line and process subtotals -->
    <!-- Set the variables representing the groups for the current line for comparison with the previous line -->
    <tr><td class = "ffrhidden">
    <apex:variable value="{!line.groups['01']}" var="currentLineGroup01" rendered="{!RenderGroup01}"/>
    <apex:variable value="{!line.groups['02']}" var="currentLineGroup02" rendered="{!RenderGroup02}"/>
    <apex:variable value="{!line.groups['03']}" var="currentLineGroup03" rendered="{!RenderGroup03}"/>
    <apex:variable value="{!line.groups['04']}" var="currentLineGroup04" rendered="{!RenderGroup04}"/>
    <apex:variable value="{!line.groups['05']}" var="currentLineGroup05" rendered="{!RenderGroup05}"/>
    </td></tr>
    <!-- Mid-row subtotal line -->
    <!-- Do we want to process a (mid-row) subtotal line? -->
    <apex:variable var="doSubtotal" value="{!RenderGroupSubtotals && !firstLine && (currentLineGroup01!=previousLineGroup01 || currentLineGroup02!=previousLineGroup02 || currentLineGroup03!=previousLineGroup03|| currentLineGroup04!=previousLineGroup04|| currentLineGroup05!=previousLineGroup05)}"/>
    <!-- Process a subtotal line -->
    <tr>
    <!-- Display the group-group values but not the group-line values -->
    <td class="{!if(doSubtotal && RenderGroup01,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup01}">{!previousLineGroup01}</apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderGroup02,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup02}">{!previousLineGroup02}</apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderGroup03,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup03}">{!previousLineGroup03}</apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderGroup04,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup04}">{!previousLineGroup04}</apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderGroup05,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup05}">{!previousLineGroup05}</apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderGroup10,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup10}"></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderGroup11,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup11}"></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderGroup12,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup12}"></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderGroup13,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup13}"></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderGroup14,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup14}"></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderGroup15,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup15}"></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderGroup16,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup16}"></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderGroup17,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup17}"></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderGroup18,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup18}"></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderGroup19,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup19}"></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderGroup20,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderGroup20}"></apex:outputPanel></td>
    <td class="{!if(doSubtotal,'ffrgridspacerd','ffrhidden')}"></td>
    <!-- Subtotals for Sum Values A -->
    <td class="{!if(doSubtotal && RenderColumnA,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnA}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnA}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnB,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnB}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnB}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnC,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnC}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnC}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnD,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnD}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnD}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnE,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnE}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnE}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnF,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnF}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnF}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnG,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnG}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnG}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnH,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnH}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnH}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnI,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnI}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnI}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnJ,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnJ}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnJ}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnK,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnK}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnK}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnL,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnL}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnL}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnM,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnM}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnM}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnN,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnN}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnN}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnO,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnO}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnO}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnP,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnP}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnP}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnQ,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnQ}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnQ}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnR,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnR}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnR}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnS,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnS}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnS}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnT,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnT}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnT}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnU,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnU}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnU}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnV,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnV}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnV}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnW,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnW}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnW}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnX,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnX}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnX}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnY,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnY}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnY}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnZ,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnZ}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnZ}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal,'ffrgridspacerd','ffrhidden')}"></td>
    <td class="{!if(doSubtotal && RenderAnyColumn,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderAnyColumn}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnAll}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal,'ffrgridspacerd','ffrhidden')}"></td>
    <!-- Subtotals for Sum Values B -->
    <td class="{!if(doSubtotal && RenderColumnA,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnA}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnA}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnB,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnB}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnB}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnC,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnC}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnC}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnD,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnD}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnD}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnE,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnE}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnE}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnF,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnF}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnF}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnG,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnG}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnG}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnH,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnH}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnH}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnI,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnI}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnI}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnJ,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnJ}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnJ}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnK,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnK}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnK}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnL,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnL}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnL}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnM,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnM}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnM}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnN,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnN}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnN}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnO,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnO}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnO}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnP,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnP}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnP}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnQ,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnQ}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnQ}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnR,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnR}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnR}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnS,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnS}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnS}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnT,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnT}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnT}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnU,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnU}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnU}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnV,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnV}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnV}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnW,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnW}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnW}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnX,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnX}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnX}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnY,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnY}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnY}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal && RenderColumnZ,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderColumnZ}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnZ}"/></apex:outputPanel></td>
    <td class="{!if(doSubtotal,'ffrgridspacerd','ffrhidden')}"></td>
    <td class="{!if(doSubtotal && RenderAnyColumn,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!doSubtotal && RenderAnyColumn}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnAll}"/></apex:outputPanel></td>
    <!-- Columns Total -->
    <!-- Running Total -->
    </tr>
    <!-- Reset the subtotals -->
    <tr><td class="ffrhidden">
    <!-- Subtotals for Sum Values A -->
    <apex:variable value="{!0}" var="rowSubtotalAColumnA" rendered="{!doSubtotal && RenderColumnA}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnB" rendered="{!doSubtotal && RenderColumnB}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnC" rendered="{!doSubtotal && RenderColumnC}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnD" rendered="{!doSubtotal && RenderColumnD}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnE" rendered="{!doSubtotal && RenderColumnE}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnF" rendered="{!doSubtotal && RenderColumnF}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnG" rendered="{!doSubtotal && RenderColumnG}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnH" rendered="{!doSubtotal && RenderColumnH}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnI" rendered="{!doSubtotal && RenderColumnI}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnJ" rendered="{!doSubtotal && RenderColumnJ}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnK" rendered="{!doSubtotal && RenderColumnK}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnL" rendered="{!doSubtotal && RenderColumnL}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnM" rendered="{!doSubtotal && RenderColumnM}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnN" rendered="{!doSubtotal && RenderColumnN}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnO" rendered="{!doSubtotal && RenderColumnO}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnP" rendered="{!doSubtotal && RenderColumnP}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnQ" rendered="{!doSubtotal && RenderColumnQ}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnR" rendered="{!doSubtotal && RenderColumnR}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnS" rendered="{!doSubtotal && RenderColumnS}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnT" rendered="{!doSubtotal && RenderColumnT}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnU" rendered="{!doSubtotal && RenderColumnU}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnV" rendered="{!doSubtotal && RenderColumnV}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnW" rendered="{!doSubtotal && RenderColumnW}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnX" rendered="{!doSubtotal && RenderColumnX}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnY" rendered="{!doSubtotal && RenderColumnY}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnZ" rendered="{!doSubtotal && RenderColumnZ}"/>
    <apex:variable value="{!0}" var="rowSubtotalAColumnAll" rendered="{!doSubtotal && RenderAnyColumn}"/>
    <!-- Subtotals for Sum Values B -->
    <apex:variable value="{!0}" var="rowSubtotalBColumnA" rendered="{!doSubtotal && RenderColumnA}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnB" rendered="{!doSubtotal && RenderColumnB}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnC" rendered="{!doSubtotal && RenderColumnC}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnD" rendered="{!doSubtotal && RenderColumnD}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnE" rendered="{!doSubtotal && RenderColumnE}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnF" rendered="{!doSubtotal && RenderColumnF}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnG" rendered="{!doSubtotal && RenderColumnG}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnH" rendered="{!doSubtotal && RenderColumnH}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnI" rendered="{!doSubtotal && RenderColumnI}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnJ" rendered="{!doSubtotal && RenderColumnJ}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnK" rendered="{!doSubtotal && RenderColumnK}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnL" rendered="{!doSubtotal && RenderColumnL}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnM" rendered="{!doSubtotal && RenderColumnM}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnN" rendered="{!doSubtotal && RenderColumnN}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnO" rendered="{!doSubtotal && RenderColumnO}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnP" rendered="{!doSubtotal && RenderColumnP}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnQ" rendered="{!doSubtotal && RenderColumnQ}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnR" rendered="{!doSubtotal && RenderColumnR}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnS" rendered="{!doSubtotal && RenderColumnS}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnT" rendered="{!doSubtotal && RenderColumnT}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnU" rendered="{!doSubtotal && RenderColumnU}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnV" rendered="{!doSubtotal && RenderColumnV}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnW" rendered="{!doSubtotal && RenderColumnW}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnX" rendered="{!doSubtotal && RenderColumnX}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnY" rendered="{!doSubtotal && RenderColumnY}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnZ" rendered="{!doSubtotal && RenderColumnZ}"/>
    <apex:variable value="{!0}" var="rowSubtotalBColumnAll" rendered="{!doSubtotal && RenderAnyColumn}"/>
    </td></tr>
    <!-- Line setup -->
    <!-- Each column is configured independently within an outputPanel the outputpanel rendered property determines whether the column is configured -->
    <!-- This uses the column render state variable (e.g. "renderColumnA" determines whether the panel for column A is configured and rendered) -->
    <!-- Set up Lines -->
    <apex:variable value="{!0}" var="lineTotal"/>
    <apex:variable value="{!0}" var="lineTotalAA"/>
    <apex:variable value="{!0}" var="lineTotalBA"/>
    <apex:variable value="{!0}" var="lineTotalCA"/>
    <apex:variable value="{!0}" var="lineTotalDA"/>
    <apex:variable value="{!0}" var="lineTotalEA"/>
    <apex:variable value="{!0}" var="lineTotalFA"/>
    <apex:variable value="{!0}" var="lineTotalGA"/>
    <apex:variable value="{!0}" var="lineTotalHA"/>
    <apex:variable value="{!0}" var="lineTotalIA"/>
    <apex:variable value="{!0}" var="lineTotalJA"/>
    <apex:variable value="{!0}" var="lineTotalKA"/>
    <apex:variable value="{!0}" var="lineTotalLA"/>
    <apex:variable value="{!0}" var="lineTotalMA"/>
    <apex:variable value="{!0}" var="lineTotalNA"/>
    <apex:variable value="{!0}" var="lineTotalOA"/>
    <apex:variable value="{!0}" var="lineTotalPA"/>
    <apex:variable value="{!0}" var="lineTotalQA"/>
    <apex:variable value="{!0}" var="lineTotalRA"/>
    <apex:variable value="{!0}" var="lineTotalSA"/>
    <apex:variable value="{!0}" var="lineTotalTA"/>
    <apex:variable value="{!0}" var="lineTotalUA"/>
    <apex:variable value="{!0}" var="lineTotalVA"/>
    <apex:variable value="{!0}" var="lineTotalWA"/>
    <apex:variable value="{!0}" var="lineTotalXA"/>
    <apex:variable value="{!0}" var="lineTotalYA"/>
    <apex:variable value="{!0}" var="lineTotalZA"/>
    <apex:variable value="{!0}" var="lineTotalAllA"/>
    <apex:variable value="{!0}" var="lineTotalAB"/>
    <apex:variable value="{!0}" var="lineTotalBB"/>
    <apex:variable value="{!0}" var="lineTotalCB"/>
    <apex:variable value="{!0}" var="lineTotalDB"/>
    <apex:variable value="{!0}" var="lineTotalEB"/>
    <apex:variable value="{!0}" var="lineTotalFB"/>
    <apex:variable value="{!0}" var="lineTotalGB"/>
    <apex:variable value="{!0}" var="lineTotalHB"/>
    <apex:variable value="{!0}" var="lineTotalIB"/>
    <apex:variable value="{!0}" var="lineTotalJB"/>
    <apex:variable value="{!0}" var="lineTotalKB"/>
    <apex:variable value="{!0}" var="lineTotalLB"/>
    <apex:variable value="{!0}" var="lineTotalMB"/>
    <apex:variable value="{!0}" var="lineTotalNB"/>
    <apex:variable value="{!0}" var="lineTotalOB"/>
    <apex:variable value="{!0}" var="lineTotalPB"/>
    <apex:variable value="{!0}" var="lineTotalQB"/>
    <apex:variable value="{!0}" var="lineTotalRB"/>
    <apex:variable value="{!0}" var="lineTotalSB"/>
    <apex:variable value="{!0}" var="lineTotalTB"/>
    <apex:variable value="{!0}" var="lineTotalUB"/>
    <apex:variable value="{!0}" var="lineTotalVB"/>
    <apex:variable value="{!0}" var="lineTotalWB"/>
    <apex:variable value="{!0}" var="lineTotalXB"/>
    <apex:variable value="{!0}" var="lineTotalYB"/>
    <apex:variable value="{!0}" var="lineTotalZB"/>
    <apex:variable value="{!0}" var="lineTotalAllB"/>
    <!-- For each column, add the column value to the line total and sub-total - column-row totals are updated separately -->
    <tr><td class="ffrhidden">
    <!-- Set up Lines for the first Sum type Reporting Value (Value = A) -->
    <apex:outputPanel layout="none" rendered="{!RenderColumnA}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['A'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnA+VALUE(TEXT(line.columns['A'].values['A']))}" var="rowSubtotalAColumnA"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnB}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['B'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnB+VALUE(TEXT(line.columns['B'].values['A']))}" var="rowSubtotalAColumnB"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnC}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['C'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnC+VALUE(TEXT(line.columns['C'].values['A']))}" var="rowSubtotalAColumnC"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnD}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['D'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnD+VALUE(TEXT(line.columns['D'].values['A']))}" var="rowSubtotalAColumnD"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnE}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['E'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnE+VALUE(TEXT(line.columns['E'].values['A']))}" var="rowSubtotalAColumnE"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnF}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['F'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnF+VALUE(TEXT(line.columns['F'].values['A']))}" var="rowSubtotalAColumnF"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnG}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['G'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnG+VALUE(TEXT(line.columns['G'].values['A']))}" var="rowSubtotalAColumnG"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnH}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['H'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnH+VALUE(TEXT(line.columns['H'].values['A']))}" var="rowSubtotalAColumnH"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnI}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['I'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnI+VALUE(TEXT(line.columns['I'].values['A']))}" var="rowSubtotalAColumnI"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnJ}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['J'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnJ+VALUE(TEXT(line.columns['J'].values['A']))}" var="rowSubtotalAColumnJ"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnK}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['K'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnK+VALUE(TEXT(line.columns['K'].values['A']))}" var="rowSubtotalAColumnK"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnL}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['L'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnL+VALUE(TEXT(line.columns['L'].values['A']))}" var="rowSubtotalAColumnL"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnM}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['M'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnM+VALUE(TEXT(line.columns['M'].values['A']))}" var="rowSubtotalAColumnM"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnN}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['N'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnN+VALUE(TEXT(line.columns['N'].values['A']))}" var="rowSubtotalAColumnN"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnO}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['O'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnO+VALUE(TEXT(line.columns['O'].values['A']))}" var="rowSubtotalAColumnO"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnP}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['P'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnP+VALUE(TEXT(line.columns['P'].values['A']))}" var="rowSubtotalAColumnP"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnQ}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['Q'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnQ+VALUE(TEXT(line.columns['Q'].values['A']))}" var="rowSubtotalAColumnQ"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnR}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['R'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnR+VALUE(TEXT(line.columns['R'].values['A']))}" var="rowSubtotalAColumnR"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnS}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['S'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnS+VALUE(TEXT(line.columns['S'].values['A']))}" var="rowSubtotalAColumnS"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnT}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['T'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnT+VALUE(TEXT(line.columns['T'].values['A']))}" var="rowSubtotalAColumnT"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnU}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['U'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnU+VALUE(TEXT(line.columns['U'].values['A']))}" var="rowSubtotalAColumnU"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnV}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['V'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnV+VALUE(TEXT(line.columns['V'].values['A']))}" var="rowSubtotalAColumnV"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnW}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['W'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnW+VALUE(TEXT(line.columns['W'].values['A']))}" var="rowSubtotalAColumnW"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnX}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['X'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnX+VALUE(TEXT(line.columns['X'].values['A']))}" var="rowSubtotalAColumnX"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnY}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['Y'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnY+VALUE(TEXT(line.columns['Y'].values['A']))}" var="rowSubtotalAColumnY"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnZ}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['Z'].values['A']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalAColumnZ+VALUE(TEXT(line.columns['Z'].values['A']))}" var="rowSubtotalAColumnZ"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderAnyColumn}">
    <apex:variable value="{!IF(RenderColumnA,lineTotalAA+VALUE(TEXT(line.columns['A'].values['A'])),0)}" var="lineTotalAA"/>
    <apex:variable value="{!IF(RenderColumnB,lineTotalBA+VALUE(TEXT(line.columns['B'].values['A'])),0)}" var="lineTotalBA"/>
    <apex:variable value="{!IF(RenderColumnC,lineTotalCA+VALUE(TEXT(line.columns['C'].values['A'])),0)}" var="lineTotalCA"/>
    <apex:variable value="{!IF(RenderColumnD,lineTotalDA+VALUE(TEXT(line.columns['D'].values['A'])),0)}" var="lineTotalDA"/>
    <apex:variable value="{!IF(RenderColumnE,lineTotalEA+VALUE(TEXT(line.columns['E'].values['A'])),0)}" var="lineTotalEA"/>
    <apex:variable value="{!IF(RenderColumnF,lineTotalFA+VALUE(TEXT(line.columns['F'].values['A'])),0)}" var="lineTotalFA"/>
    <apex:variable value="{!IF(RenderColumnG,lineTotalGA+VALUE(TEXT(line.columns['G'].values['A'])),0)}" var="lineTotalGA"/>
    <apex:variable value="{!IF(RenderColumnH,lineTotalHA+VALUE(TEXT(line.columns['H'].values['A'])),0)}" var="lineTotalHA"/>
    <apex:variable value="{!IF(RenderColumnI,lineTotalIA+VALUE(TEXT(line.columns['I'].values['A'])),0)}" var="lineTotalIA"/>
    <apex:variable value="{!IF(RenderColumnJ,lineTotalJA+VALUE(TEXT(line.columns['J'].values['A'])),0)}" var="lineTotalJA"/>
    <apex:variable value="{!IF(RenderColumnK,lineTotalKA+VALUE(TEXT(line.columns['K'].values['A'])),0)}" var="lineTotalKA"/>
    <apex:variable value="{!IF(RenderColumnL,lineTotalLA+VALUE(TEXT(line.columns['L'].values['A'])),0)}" var="lineTotalLA"/>
    <apex:variable value="{!IF(RenderColumnM,lineTotalMA+VALUE(TEXT(line.columns['M'].values['A'])),0)}" var="lineTotalMA"/>
    <apex:variable value="{!IF(RenderColumnN,lineTotalNA+VALUE(TEXT(line.columns['N'].values['A'])),0)}" var="lineTotalNA"/>
    <apex:variable value="{!IF(RenderColumnO,lineTotalOA+VALUE(TEXT(line.columns['O'].values['A'])),0)}" var="lineTotalOA"/>
    <apex:variable value="{!IF(RenderColumnP,lineTotalPA+VALUE(TEXT(line.columns['P'].values['A'])),0)}" var="lineTotalPA"/>
    <apex:variable value="{!IF(RenderColumnQ,lineTotalQA+VALUE(TEXT(line.columns['Q'].values['A'])),0)}" var="lineTotalQA"/>
    <apex:variable value="{!IF(RenderColumnR,lineTotalRA+VALUE(TEXT(line.columns['R'].values['A'])),0)}" var="lineTotalRA"/>
    <apex:variable value="{!IF(RenderColumnS,lineTotalSA+VALUE(TEXT(line.columns['S'].values['A'])),0)}" var="lineTotalSA"/>
    <apex:variable value="{!IF(RenderColumnT,lineTotalTA+VALUE(TEXT(line.columns['T'].values['A'])),0)}" var="lineTotalTA"/>
    <apex:variable value="{!IF(RenderColumnU,lineTotalUA+VALUE(TEXT(line.columns['U'].values['A'])),0)}" var="lineTotalUA"/>
    <apex:variable value="{!IF(RenderColumnV,lineTotalVA+VALUE(TEXT(line.columns['V'].values['A'])),0)}" var="lineTotalVA"/>
    <apex:variable value="{!IF(RenderColumnW,lineTotalWA+VALUE(TEXT(line.columns['W'].values['A'])),0)}" var="lineTotalWA"/>
    <apex:variable value="{!IF(RenderColumnX,lineTotalXA+VALUE(TEXT(line.columns['X'].values['A'])),0)}" var="lineTotalXA"/>
    <apex:variable value="{!IF(RenderColumnY,lineTotalYA+VALUE(TEXT(line.columns['Y'].values['A'])),0)}" var="lineTotalYA"/>
    <apex:variable value="{!IF(RenderColumnZ,lineTotalZA+VALUE(TEXT(line.columns['Z'].values['A'])),0)}" var="lineTotalZA"/>
    <apex:variable value="{!lineTotalAllA+lineTotalAA+lineTotalBA+lineTotalCA+lineTotalDA+lineTotalEA+lineTotalFA+lineTotalGA+lineTotalHA+lineTotalIA+lineTotalJA+lineTotalKA+lineTotalLA+lineTotalMA+lineTotalNA+lineTotalOA+lineTotalPA+lineTotalQA+lineTotalRA+lineTotalSA+lineTotalTA+lineTotalUA+lineTotalVA+lineTotalWA+lineTotalXA+lineTotalYA+lineTotalZA}" var="lineTotalAllA"/>
    <apex:variable value="{!rowSubtotalAColumnAll+lineTotalAA+lineTotalBA+lineTotalCA+lineTotalDA+lineTotalEA+lineTotalFA+lineTotalGA+lineTotalHA+lineTotalIA+lineTotalJA+lineTotalKA+lineTotalLA+lineTotalMA+lineTotalNA+lineTotalOA+lineTotalPA+lineTotalQA+lineTotalRA+lineTotalSA+lineTotalTA+lineTotalUA+lineTotalVA+lineTotalWA+lineTotalXA+lineTotalYA+lineTotalZA}" var="rowSubtotalAColumnAll"/>
    </apex:outputPanel>
    <!-- Set up Lines for the second Sum type Reporting Value (Value = B) -->
    <apex:outputPanel layout="none" rendered="{!RenderColumnA}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['A'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnA+VALUE(TEXT(line.columns['A'].values['B']))}" var="rowSubtotalBColumnA"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnB}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['B'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnB+VALUE(TEXT(line.columns['B'].values['B']))}" var="rowSubtotalBColumnB"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnC}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['C'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnC+VALUE(TEXT(line.columns['C'].values['B']))}" var="rowSubtotalBColumnC"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnD}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['D'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnD+VALUE(TEXT(line.columns['D'].values['B']))}" var="rowSubtotalBColumnD"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnE}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['E'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnE+VALUE(TEXT(line.columns['E'].values['B']))}" var="rowSubtotalBColumnE"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnF}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['F'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnF+VALUE(TEXT(line.columns['F'].values['B']))}" var="rowSubtotalBColumnF"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnG}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['G'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnG+VALUE(TEXT(line.columns['G'].values['B']))}" var="rowSubtotalBColumnG"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnH}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['H'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnH+VALUE(TEXT(line.columns['H'].values['B']))}" var="rowSubtotalBColumnH"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnI}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['I'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnI+VALUE(TEXT(line.columns['I'].values['B']))}" var="rowSubtotalBColumnI"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnJ}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['J'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnJ+VALUE(TEXT(line.columns['J'].values['B']))}" var="rowSubtotalBColumnJ"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnK}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['K'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnK+VALUE(TEXT(line.columns['K'].values['B']))}" var="rowSubtotalBColumnK"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnL}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['L'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnL+VALUE(TEXT(line.columns['L'].values['B']))}" var="rowSubtotalBColumnL"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnM}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['M'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnM+VALUE(TEXT(line.columns['M'].values['B']))}" var="rowSubtotalBColumnM"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnN}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['N'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnN+VALUE(TEXT(line.columns['N'].values['B']))}" var="rowSubtotalBColumnN"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnO}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['O'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnO+VALUE(TEXT(line.columns['O'].values['B']))}" var="rowSubtotalBColumnO"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnP}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['P'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnP+VALUE(TEXT(line.columns['P'].values['B']))}" var="rowSubtotalBColumnP"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnQ}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['Q'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnQ+VALUE(TEXT(line.columns['Q'].values['B']))}" var="rowSubtotalBColumnQ"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnR}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['R'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnR+VALUE(TEXT(line.columns['R'].values['B']))}" var="rowSubtotalBColumnR"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnS}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['S'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnS+VALUE(TEXT(line.columns['S'].values['B']))}" var="rowSubtotalBColumnS"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnT}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['T'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnT+VALUE(TEXT(line.columns['T'].values['B']))}" var="rowSubtotalBColumnT"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnU}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['U'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnU+VALUE(TEXT(line.columns['U'].values['B']))}" var="rowSubtotalBColumnU"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnV}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['V'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnV+VALUE(TEXT(line.columns['V'].values['B']))}" var="rowSubtotalBColumnV"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnW}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['W'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnW+VALUE(TEXT(line.columns['W'].values['B']))}" var="rowSubtotalBColumnW"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnX}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['X'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnX+VALUE(TEXT(line.columns['X'].values['B']))}" var="rowSubtotalBColumnX"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnY}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['Y'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnY+VALUE(TEXT(line.columns['Y'].values['B']))}" var="rowSubtotalBColumnY"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnZ}">
    <apex:variable value="{!lineTotal+VALUE(TEXT(line.columns['Z'].values['B']))}" var="lineTotal"/>
    <apex:variable value="{!rowSubtotalBColumnZ+VALUE(TEXT(line.columns['Z'].values['B']))}" var="rowSubtotalBColumnZ"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderAnyColumn}">
    <apex:variable value="{!IF(RenderColumnA,lineTotalAB+VALUE(TEXT(line.columns['A'].values['B'])),0)}" var="lineTotalAB"/>
    <apex:variable value="{!IF(RenderColumnB,lineTotalBB+VALUE(TEXT(line.columns['B'].values['B'])),0)}" var="lineTotalBB"/>
    <apex:variable value="{!IF(RenderColumnC,lineTotalCB+VALUE(TEXT(line.columns['C'].values['B'])),0)}" var="lineTotalCB"/>
    <apex:variable value="{!IF(RenderColumnD,lineTotalDB+VALUE(TEXT(line.columns['D'].values['B'])),0)}" var="lineTotalDB"/>
    <apex:variable value="{!IF(RenderColumnE,lineTotalEB+VALUE(TEXT(line.columns['E'].values['B'])),0)}" var="lineTotalEB"/>
    <apex:variable value="{!IF(RenderColumnF,lineTotalFB+VALUE(TEXT(line.columns['F'].values['B'])),0)}" var="lineTotalFB"/>
    <apex:variable value="{!IF(RenderColumnG,lineTotalGB+VALUE(TEXT(line.columns['G'].values['B'])),0)}" var="lineTotalGB"/>
    <apex:variable value="{!IF(RenderColumnH,lineTotalHB+VALUE(TEXT(line.columns['H'].values['B'])),0)}" var="lineTotalHB"/>
    <apex:variable value="{!IF(RenderColumnI,lineTotalIB+VALUE(TEXT(line.columns['I'].values['B'])),0)}" var="lineTotalIB"/>
    <apex:variable value="{!IF(RenderColumnJ,lineTotalJB+VALUE(TEXT(line.columns['J'].values['B'])),0)}" var="lineTotalJB"/>
    <apex:variable value="{!IF(RenderColumnK,lineTotalKB+VALUE(TEXT(line.columns['K'].values['B'])),0)}" var="lineTotalKB"/>
    <apex:variable value="{!IF(RenderColumnL,lineTotalLB+VALUE(TEXT(line.columns['L'].values['B'])),0)}" var="lineTotalLB"/>
    <apex:variable value="{!IF(RenderColumnM,lineTotalMB+VALUE(TEXT(line.columns['M'].values['B'])),0)}" var="lineTotalMB"/>
    <apex:variable value="{!IF(RenderColumnN,lineTotalNB+VALUE(TEXT(line.columns['N'].values['B'])),0)}" var="lineTotalNB"/>
    <apex:variable value="{!IF(RenderColumnO,lineTotalOB+VALUE(TEXT(line.columns['O'].values['B'])),0)}" var="lineTotalOB"/>
    <apex:variable value="{!IF(RenderColumnP,lineTotalPB+VALUE(TEXT(line.columns['P'].values['B'])),0)}" var="lineTotalPB"/>
    <apex:variable value="{!IF(RenderColumnQ,lineTotalQB+VALUE(TEXT(line.columns['Q'].values['B'])),0)}" var="lineTotalQB"/>
    <apex:variable value="{!IF(RenderColumnR,lineTotalRB+VALUE(TEXT(line.columns['R'].values['B'])),0)}" var="lineTotalRB"/>
    <apex:variable value="{!IF(RenderColumnS,lineTotalSB+VALUE(TEXT(line.columns['S'].values['B'])),0)}" var="lineTotalSB"/>
    <apex:variable value="{!IF(RenderColumnT,lineTotalTB+VALUE(TEXT(line.columns['T'].values['B'])),0)}" var="lineTotalTB"/>
    <apex:variable value="{!IF(RenderColumnU,lineTotalUB+VALUE(TEXT(line.columns['U'].values['B'])),0)}" var="lineTotalUB"/>
    <apex:variable value="{!IF(RenderColumnV,lineTotalVB+VALUE(TEXT(line.columns['V'].values['B'])),0)}" var="lineTotalVB"/>
    <apex:variable value="{!IF(RenderColumnW,lineTotalWB+VALUE(TEXT(line.columns['W'].values['B'])),0)}" var="lineTotalWB"/>
    <apex:variable value="{!IF(RenderColumnX,lineTotalXB+VALUE(TEXT(line.columns['X'].values['B'])),0)}" var="lineTotalXB"/>
    <apex:variable value="{!IF(RenderColumnY,lineTotalYB+VALUE(TEXT(line.columns['Y'].values['B'])),0)}" var="lineTotalYB"/>
    <apex:variable value="{!IF(RenderColumnZ,lineTotalZB+VALUE(TEXT(line.columns['Z'].values['B'])),0)}" var="lineTotalZB"/>
    <apex:variable value="{!lineTotalAllB+lineTotalAB+lineTotalBB+lineTotalCB+lineTotalDB+lineTotalEB+lineTotalFB+lineTotalGB+lineTotalHB+lineTotalIB+lineTotalJB+lineTotalKB+lineTotalLB+lineTotalMB+lineTotalNB+lineTotalOB+lineTotalPB+lineTotalQB+lineTotalRB+lineTotalSB+lineTotalTB+lineTotalUB+lineTotalVB+lineTotalWB+lineTotalXB+lineTotalYB+lineTotalZB}" var="lineTotalAllB"/>
    <apex:variable value="{!rowSubtotalBColumnAll+lineTotalAB+lineTotalBB+lineTotalCB+lineTotalDB+lineTotalEB+lineTotalFB+lineTotalGB+lineTotalHB+lineTotalIB+lineTotalJB+lineTotalKB+lineTotalLB+lineTotalMB+lineTotalNB+lineTotalOB+lineTotalPB+lineTotalQB+lineTotalRB+lineTotalSB+lineTotalTB+lineTotalUB+lineTotalVB+lineTotalWB+lineTotalXB+lineTotalYB+lineTotalZB}" var="rowSubtotalBColumnAll"/>
    </apex:outputPanel>
    </td></tr>
    <!-- Display the line -->
    <tr>
    <!-- Display the grouping values based on render settings -->
    <td class="{!if(RenderGroup01,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup01}">{!currentLineGroup01}</apex:outputPanel></td>
    <td class="{!if(RenderGroup02,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup02}">{!currentLineGroup02}</apex:outputPanel></td>
    <td class="{!if(RenderGroup03,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup03}">{!currentLineGroup03}</apex:outputPanel></td>
    <td class="{!if(RenderGroup04,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup04}">{!currentLineGroup04}</apex:outputPanel></td>
    <td class="{!if(RenderGroup05,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup05}">{!currentLineGroup05}</apex:outputPanel></td>
    <td class="{!if(RenderGroup10,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup10}">{!line.groups['10']}</apex:outputPanel></td>
    <td class="{!if(RenderGroup11,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup11}">{!line.groups['11']}</apex:outputPanel></td>
    <td class="{!if(RenderGroup12,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup12}">{!line.groups['12']}</apex:outputPanel></td>
    <td class="{!if(RenderGroup13,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup13}">{!line.groups['13']}</apex:outputPanel></td>
    <td class="{!if(RenderGroup14,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup14}">{!line.groups['14']}</apex:outputPanel></td>
    <td class="{!if(RenderGroup15,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup15}">{!line.groups['15']}</apex:outputPanel></td>
    <td class="{!if(RenderGroup16,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup16}">{!line.groups['16']}</apex:outputPanel></td>
    <td class="{!if(RenderGroup17,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup17}">{!line.groups['17']}</apex:outputPanel></td>
    <td class="{!if(RenderGroup18,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup18}">{!line.groups['18']}</apex:outputPanel></td>
    <td class="{!if(RenderGroup19,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup19}">{!line.groups['19']}</apex:outputPanel></td>
    <td class="{!if(RenderGroup20,'ffrgridrowlabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup20}">{!line.groups['20']}</apex:outputPanel></td>
    <td class="ffrgridspacerd"/>
    <!-- Each column is contained within an outputPanel which simply controls whether it is rendered: -->
    <!-- Assign the value to a Visualforce variable so that it can be used in the NumberFormatter component -->
    <!-- (Note that this is a workaround for a VF bug - we should not need set up a variable for this) -->
    <!-- Display the line value, formatted using a NumberFormatter component with the pattern defined above -->
    <!-- (Note that we are reusing a temporary variable "v") -->
    <!-- Display Lines for the first Sum type Reporting Value (Value = A) -->
    <td class="{!if(RenderColumnA,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnA}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['A'].values['A'])), VALUE(TEXT(line.columns['A'].values['A'])),0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnB,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnB}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['B'].values['A'])), VALUE(TEXT(line.columns['B'].values['A'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnC,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnC}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['C'].values['A'])), VALUE(TEXT(line.columns['C'].values['A'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnD,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnD}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['D'].values['A'])), VALUE(TEXT(line.columns['D'].values['A'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnE,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnE}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['E'].values['A'])), VALUE(TEXT(line.columns['E'].values['A'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnF,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnF}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['F'].values['A'])), VALUE(TEXT(line.columns['F'].values['A'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnG,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnG}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['G'].values['A'])), VALUE(TEXT(line.columns['G'].values['A'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnH,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnH}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['H'].values['A'])), VALUE(TEXT(line.columns['H'].values['A'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnI,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnI}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['I'].values['A'])), VALUE(TEXT(line.columns['I'].values['A'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnJ,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnJ}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['J'].values['A'])), VALUE(TEXT(line.columns['J'].values['A'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnK,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnK}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['K'].values['A'])), VALUE(TEXT(line.columns['K'].values['A'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnL,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnL}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['L'].values['A'])), VALUE(TEXT(line.columns['L'].values['A'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnM,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnM}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['M'].values['A'])), VALUE(TEXT(line.columns['M'].values['A'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnN,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnN}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['N'].values['A'])), VALUE(TEXT(line.columns['N'].values['A'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnO,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnO}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['O'].values['A'])), VALUE(TEXT(line.columns['O'].values['A'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnP,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnP}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['P'].values['A'])), VALUE(TEXT(line.columns['P'].values['A'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnQ,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnQ}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['Q'].values['A'])), VALUE(TEXT(line.columns['Q'].values['A'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnR,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnR}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['R'].values['A'])), VALUE(TEXT(line.columns['R'].values['A'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnS,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnS}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['S'].values['A'])), VALUE(TEXT(line.columns['S'].values['A'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnT,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnT}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['T'].values['A'])), VALUE(TEXT(line.columns['T'].values['A'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnU,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnU}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['U'].values['A'])), VALUE(TEXT(line.columns['U'].values['A'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnV,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnV}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['V'].values['A'])), VALUE(TEXT(line.columns['V'].values['A'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnW,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnW}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['W'].values['A'])), VALUE(TEXT(line.columns['W'].values['A'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnX,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnX}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['X'].values['A'])), VALUE(TEXT(line.columns['X'].values['A'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnY,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnY}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['Y'].values['A'])), VALUE(TEXT(line.columns['Y'].values['A'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnZ,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnZ}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['Z'].values['A'])), VALUE(TEXT(line.columns['Z'].values['A'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="ffrgridspacerd"/>
    <td class="{!if(RenderAnyColumn,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderAnyColumn}">
    <apex:variable value="{!IF(RenderColumnA && ISNUMBER(TEXT(line.columns['A'].values['A'])), VALUE(TEXT(line.columns['A'].values['A'])),0)}" var="vAA"/>
    <apex:variable value="{!IF(RenderColumnB && ISNUMBER(TEXT(line.columns['B'].values['A'])), VALUE(TEXT(line.columns['B'].values['A'])),0)}" var="vBA"/>
    <apex:variable value="{!IF(RenderColumnC && ISNUMBER(TEXT(line.columns['C'].values['A'])), VALUE(TEXT(line.columns['C'].values['A'])),0)}" var="vCA"/>
    <apex:variable value="{!IF(RenderColumnD && ISNUMBER(TEXT(line.columns['D'].values['A'])), VALUE(TEXT(line.columns['D'].values['A'])),0)}" var="vDA"/>
    <apex:variable value="{!IF(RenderColumnE && ISNUMBER(TEXT(line.columns['E'].values['A'])), VALUE(TEXT(line.columns['E'].values['A'])),0)}" var="vEA"/>
    <apex:variable value="{!IF(RenderColumnF && ISNUMBER(TEXT(line.columns['F'].values['A'])), VALUE(TEXT(line.columns['F'].values['A'])),0)}" var="vFA"/>
    <apex:variable value="{!IF(RenderColumnG && ISNUMBER(TEXT(line.columns['G'].values['A'])), VALUE(TEXT(line.columns['G'].values['A'])),0)}" var="vGA"/>
    <apex:variable value="{!IF(RenderColumnH && ISNUMBER(TEXT(line.columns['H'].values['A'])), VALUE(TEXT(line.columns['H'].values['A'])),0)}" var="vHA"/>
    <apex:variable value="{!IF(RenderColumnI && ISNUMBER(TEXT(line.columns['I'].values['A'])), VALUE(TEXT(line.columns['I'].values['A'])),0)}" var="vIA"/>
    <apex:variable value="{!IF(RenderColumnJ && ISNUMBER(TEXT(line.columns['J'].values['A'])), VALUE(TEXT(line.columns['J'].values['A'])),0)}" var="vJA"/>
    <apex:variable value="{!IF(RenderColumnK && ISNUMBER(TEXT(line.columns['K'].values['A'])), VALUE(TEXT(line.columns['K'].values['A'])),0)}" var="vKA"/>
    <apex:variable value="{!IF(RenderColumnL && ISNUMBER(TEXT(line.columns['L'].values['A'])), VALUE(TEXT(line.columns['L'].values['A'])),0)}" var="vLA"/>
    <apex:variable value="{!IF(RenderColumnM && ISNUMBER(TEXT(line.columns['M'].values['A'])), VALUE(TEXT(line.columns['M'].values['A'])),0)}" var="vMA"/>
    <apex:variable value="{!IF(RenderColumnN && ISNUMBER(TEXT(line.columns['N'].values['A'])), VALUE(TEXT(line.columns['N'].values['A'])),0)}" var="vNA"/>
    <apex:variable value="{!IF(RenderColumnO && ISNUMBER(TEXT(line.columns['O'].values['A'])), VALUE(TEXT(line.columns['O'].values['A'])),0)}" var="vOA"/>
    <apex:variable value="{!IF(RenderColumnP && ISNUMBER(TEXT(line.columns['P'].values['A'])), VALUE(TEXT(line.columns['P'].values['A'])),0)}" var="vPA"/>
    <apex:variable value="{!IF(RenderColumnQ && ISNUMBER(TEXT(line.columns['Q'].values['A'])), VALUE(TEXT(line.columns['Q'].values['A'])),0)}" var="vQA"/>
    <apex:variable value="{!IF(RenderColumnR && ISNUMBER(TEXT(line.columns['R'].values['A'])), VALUE(TEXT(line.columns['R'].values['A'])),0)}" var="vRA"/>
    <apex:variable value="{!IF(RenderColumnS && ISNUMBER(TEXT(line.columns['S'].values['A'])), VALUE(TEXT(line.columns['S'].values['A'])),0)}" var="vSA"/>
    <apex:variable value="{!IF(RenderColumnT && ISNUMBER(TEXT(line.columns['T'].values['A'])), VALUE(TEXT(line.columns['T'].values['A'])),0)}" var="vTA"/>
    <apex:variable value="{!IF(RenderColumnU && ISNUMBER(TEXT(line.columns['U'].values['A'])), VALUE(TEXT(line.columns['U'].values['A'])),0)}" var="vUA"/>
    <apex:variable value="{!IF(RenderColumnV && ISNUMBER(TEXT(line.columns['V'].values['A'])), VALUE(TEXT(line.columns['V'].values['A'])),0)}" var="vVA"/>
    <apex:variable value="{!IF(RenderColumnW && ISNUMBER(TEXT(line.columns['W'].values['A'])), VALUE(TEXT(line.columns['W'].values['A'])),0)}" var="vWA"/>
    <apex:variable value="{!IF(RenderColumnX && ISNUMBER(TEXT(line.columns['X'].values['A'])), VALUE(TEXT(line.columns['X'].values['A'])),0)}" var="vXA"/>
    <apex:variable value="{!IF(RenderColumnY && ISNUMBER(TEXT(line.columns['Y'].values['A'])), VALUE(TEXT(line.columns['Y'].values['A'])),0)}" var="vYA"/>
    <apex:variable value="{!IF(RenderColumnZ && ISNUMBER(TEXT(line.columns['Z'].values['A'])), VALUE(TEXT(line.columns['Z'].values['A'])),0)}" var="vZA"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!vAA+vBA+vCA+vDA+vEA+vFA+vGA+vHA+vIA+vJA+vKA+vLA+vMA+vNA+vOA+vPA+vQA+vRA+vSA+vTA+vUA+vVA+vWA+vXA+vYA+vZA}"/>
    </apex:outputPanel></td>
    <td class="ffrgridspacerd"/>
    <!-- Display Lines for the second Sum type Reporting Value (Value = B) -->
    <td class="{!if(RenderColumnA,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnA}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['A'].values['B'])), VALUE(TEXT(line.columns['A'].values['B'])),0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnB,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnB}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['B'].values['B'])), VALUE(TEXT(line.columns['B'].values['B'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnC,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnC}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['C'].values['B'])), VALUE(TEXT(line.columns['C'].values['B'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnD,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnD}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['D'].values['B'])), VALUE(TEXT(line.columns['D'].values['B'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnE,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnE}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['E'].values['B'])), VALUE(TEXT(line.columns['E'].values['B'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnF,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnF}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['F'].values['B'])), VALUE(TEXT(line.columns['F'].values['B'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnG,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnG}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['G'].values['B'])), VALUE(TEXT(line.columns['G'].values['B'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnH,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnH}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['H'].values['B'])), VALUE(TEXT(line.columns['H'].values['B'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnI,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnI}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['I'].values['B'])), VALUE(TEXT(line.columns['I'].values['B'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnJ,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnJ}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['J'].values['B'])), VALUE(TEXT(line.columns['J'].values['B'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnK,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnK}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['K'].values['B'])), VALUE(TEXT(line.columns['K'].values['B'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnL,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnL}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['L'].values['B'])), VALUE(TEXT(line.columns['L'].values['B'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnM,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnM}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['M'].values['B'])), VALUE(TEXT(line.columns['M'].values['B'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnN,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnN}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['N'].values['B'])), VALUE(TEXT(line.columns['N'].values['B'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnO,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnO}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['O'].values['B'])), VALUE(TEXT(line.columns['O'].values['B'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnP,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnP}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['P'].values['B'])), VALUE(TEXT(line.columns['P'].values['B'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnQ,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnQ}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['Q'].values['B'])), VALUE(TEXT(line.columns['Q'].values['B'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnR,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnR}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['R'].values['B'])), VALUE(TEXT(line.columns['R'].values['B'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnS,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnS}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['S'].values['B'])), VALUE(TEXT(line.columns['S'].values['B'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnT,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnT}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['T'].values['B'])), VALUE(TEXT(line.columns['T'].values['B'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnU,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnU}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['U'].values['B'])), VALUE(TEXT(line.columns['U'].values['B'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnV,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnV}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['V'].values['B'])), VALUE(TEXT(line.columns['V'].values['B'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnW,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnW}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['W'].values['B'])), VALUE(TEXT(line.columns['W'].values['B'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnX,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnX}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['X'].values['B'])), VALUE(TEXT(line.columns['X'].values['B'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnY,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnY}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['Y'].values['B'])), VALUE(TEXT(line.columns['Y'].values['B'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnZ,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnZ}">
    <apex:variable value="{!IF(ISNUMBER(TEXT(line.columns['Z'].values['B'])), VALUE(TEXT(line.columns['Z'].values['B'])), 0)}" var="v"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!v}"/>
    </apex:outputPanel></td>
    <td class="ffrgridspacerd"/>
    <td class="{!if(RenderAnyColumn,'ffrgridrowd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderAnyColumn}">
    <apex:variable value="{!IF(RenderColumnA && ISNUMBER(TEXT(line.columns['A'].values['B'])), VALUE(TEXT(line.columns['A'].values['B'])),0)}" var="vAB"/>
    <apex:variable value="{!IF(RenderColumnB && ISNUMBER(TEXT(line.columns['B'].values['B'])), VALUE(TEXT(line.columns['B'].values['B'])),0)}" var="vBB"/>
    <apex:variable value="{!IF(RenderColumnC && ISNUMBER(TEXT(line.columns['C'].values['B'])), VALUE(TEXT(line.columns['C'].values['B'])),0)}" var="vCB"/>
    <apex:variable value="{!IF(RenderColumnD && ISNUMBER(TEXT(line.columns['D'].values['B'])), VALUE(TEXT(line.columns['D'].values['B'])),0)}" var="vDB"/>
    <apex:variable value="{!IF(RenderColumnE && ISNUMBER(TEXT(line.columns['E'].values['B'])), VALUE(TEXT(line.columns['E'].values['B'])),0)}" var="vEB"/>
    <apex:variable value="{!IF(RenderColumnF && ISNUMBER(TEXT(line.columns['F'].values['B'])), VALUE(TEXT(line.columns['F'].values['B'])),0)}" var="vFB"/>
    <apex:variable value="{!IF(RenderColumnG && ISNUMBER(TEXT(line.columns['G'].values['B'])), VALUE(TEXT(line.columns['G'].values['B'])),0)}" var="vGB"/>
    <apex:variable value="{!IF(RenderColumnH && ISNUMBER(TEXT(line.columns['H'].values['B'])), VALUE(TEXT(line.columns['H'].values['B'])),0)}" var="vHB"/>
    <apex:variable value="{!IF(RenderColumnI && ISNUMBER(TEXT(line.columns['I'].values['B'])), VALUE(TEXT(line.columns['I'].values['B'])),0)}" var="vIB"/>
    <apex:variable value="{!IF(RenderColumnJ && ISNUMBER(TEXT(line.columns['J'].values['B'])), VALUE(TEXT(line.columns['J'].values['B'])),0)}" var="vJB"/>
    <apex:variable value="{!IF(RenderColumnK && ISNUMBER(TEXT(line.columns['K'].values['B'])), VALUE(TEXT(line.columns['K'].values['B'])),0)}" var="vKB"/>
    <apex:variable value="{!IF(RenderColumnL && ISNUMBER(TEXT(line.columns['L'].values['B'])), VALUE(TEXT(line.columns['L'].values['B'])),0)}" var="vLB"/>
    <apex:variable value="{!IF(RenderColumnM && ISNUMBER(TEXT(line.columns['M'].values['B'])), VALUE(TEXT(line.columns['M'].values['B'])),0)}" var="vMB"/>
    <apex:variable value="{!IF(RenderColumnN && ISNUMBER(TEXT(line.columns['N'].values['B'])), VALUE(TEXT(line.columns['N'].values['B'])),0)}" var="vNB"/>
    <apex:variable value="{!IF(RenderColumnO && ISNUMBER(TEXT(line.columns['O'].values['B'])), VALUE(TEXT(line.columns['O'].values['B'])),0)}" var="vOB"/>
    <apex:variable value="{!IF(RenderColumnP && ISNUMBER(TEXT(line.columns['P'].values['B'])), VALUE(TEXT(line.columns['P'].values['B'])),0)}" var="vPB"/>
    <apex:variable value="{!IF(RenderColumnQ && ISNUMBER(TEXT(line.columns['Q'].values['B'])), VALUE(TEXT(line.columns['Q'].values['B'])),0)}" var="vQB"/>
    <apex:variable value="{!IF(RenderColumnR && ISNUMBER(TEXT(line.columns['R'].values['B'])), VALUE(TEXT(line.columns['R'].values['B'])),0)}" var="vRB"/>
    <apex:variable value="{!IF(RenderColumnS && ISNUMBER(TEXT(line.columns['S'].values['B'])), VALUE(TEXT(line.columns['S'].values['B'])),0)}" var="vSB"/>
    <apex:variable value="{!IF(RenderColumnT && ISNUMBER(TEXT(line.columns['T'].values['B'])), VALUE(TEXT(line.columns['T'].values['B'])),0)}" var="vTB"/>
    <apex:variable value="{!IF(RenderColumnU && ISNUMBER(TEXT(line.columns['U'].values['B'])), VALUE(TEXT(line.columns['U'].values['B'])),0)}" var="vUB"/>
    <apex:variable value="{!IF(RenderColumnV && ISNUMBER(TEXT(line.columns['V'].values['B'])), VALUE(TEXT(line.columns['V'].values['B'])),0)}" var="vVB"/>
    <apex:variable value="{!IF(RenderColumnW && ISNUMBER(TEXT(line.columns['W'].values['B'])), VALUE(TEXT(line.columns['W'].values['B'])),0)}" var="vWB"/>
    <apex:variable value="{!IF(RenderColumnX && ISNUMBER(TEXT(line.columns['X'].values['B'])), VALUE(TEXT(line.columns['X'].values['B'])),0)}" var="vXB"/>
    <apex:variable value="{!IF(RenderColumnY && ISNUMBER(TEXT(line.columns['Y'].values['B'])), VALUE(TEXT(line.columns['Y'].values['B'])),0)}" var="vYB"/>
    <apex:variable value="{!IF(RenderColumnZ && ISNUMBER(TEXT(line.columns['Z'].values['B'])), VALUE(TEXT(line.columns['Z'].values['B'])),0)}" var="vZB"/>
        <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!vAB+vBB+vCB+vDB+vEB+vFB+vGB+vHB+vIB+vJB+vKB+vLB+vMB+vNB+vOB+vPB+vQB+vRB+vSB+vTB+vUB+vVB+vWB+vXB+vYB+vZB}"/>
    </apex:outputPanel></td>
    <!-- Columns Total -->
    <!-- Running Total is blank at line level -->
    </tr>
    <!-- Setup for next line -->
    <!-- Record the group values as "previous" for comparison on the next line -->
    <tr><td class="ffrhidden">
    <apex:variable var="previousLineGroup01" value="{!currentLineGroup01}"/>
    <apex:variable var="previousLineGroup02" value="{!currentLineGroup02}"/>
    <apex:variable var="previousLineGroup03" value="{!currentLineGroup03}"/>
    <apex:variable var="previousLineGroup04" value="{!currentLineGroup04}"/>
    <apex:variable var="previousLineGroup05" value="{!currentLineGroup05}"/>
    </td></tr>
    <!-- If this was the first line, it was completed, so set first line to false -->
    <apex:variable var="firstLine" value="{!false}" rendered="{!firstLine}" />
    <!-- Add the values to the row-column totals -->
    <!-- Row Column Totals for the first Sum type Reporting Value (Value = A) -->
    <apex:outputPanel layout="none" rendered="{!RenderColumnA}">
    <apex:variable value="{!rowTotalAColumnA+VALUE(TEXT(line.columns['A'].values['A']))}" var="rowTotalAColumnA"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnB}">
    <apex:variable value="{!rowTotalAColumnB+VALUE(TEXT(line.columns['B'].values['A']))}" var="rowTotalAColumnB"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnC}">
    <apex:variable value="{!rowTotalAColumnC+VALUE(TEXT(line.columns['C'].values['A']))}" var="rowTotalAColumnC"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnD}">
    <apex:variable value="{!rowTotalAColumnD+VALUE(TEXT(line.columns['D'].values['A']))}" var="rowTotalAColumnD"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnE}">
    <apex:variable value="{!rowTotalAColumnE+VALUE(TEXT(line.columns['E'].values['A']))}" var="rowTotalAColumnE"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnF}">
    <apex:variable value="{!rowTotalAColumnF+VALUE(TEXT(line.columns['F'].values['A']))}" var="rowTotalAColumnF"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnG}">
    <apex:variable value="{!rowTotalAColumnG+VALUE(TEXT(line.columns['G'].values['A']))}" var="rowTotalAColumnG"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnH}">
    <apex:variable value="{!rowTotalAColumnH+VALUE(TEXT(line.columns['H'].values['A']))}" var="rowTotalAColumnH"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnI}">
    <apex:variable value="{!rowTotalAColumnI+VALUE(TEXT(line.columns['I'].values['A']))}" var="rowTotalAColumnI"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnJ}">
    <apex:variable value="{!rowTotalAColumnJ+VALUE(TEXT(line.columns['J'].values['A']))}" var="rowTotalAColumnJ"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnK}">
    <apex:variable value="{!rowTotalAColumnK+VALUE(TEXT(line.columns['K'].values['A']))}" var="rowTotalAColumnK"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnL}">
    <apex:variable value="{!rowTotalAColumnL+VALUE(TEXT(line.columns['L'].values['A']))}" var="rowTotalAColumnL"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnM}">
    <apex:variable value="{!rowTotalAColumnM+VALUE(TEXT(line.columns['M'].values['A']))}" var="rowTotalAColumnM"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnN}">
    <apex:variable value="{!rowTotalAColumnN+VALUE(TEXT(line.columns['N'].values['A']))}" var="rowTotalAColumnN"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnO}">
    <apex:variable value="{!rowTotalAColumnO+VALUE(TEXT(line.columns['O'].values['A']))}" var="rowTotalAColumnO"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnP}">
    <apex:variable value="{!rowTotalAColumnP+VALUE(TEXT(line.columns['P'].values['A']))}" var="rowTotalAColumnP"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnQ}">
    <apex:variable value="{!rowTotalAColumnQ+VALUE(TEXT(line.columns['Q'].values['A']))}" var="rowTotalAColumnQ"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnR}">
    <apex:variable value="{!rowTotalAColumnR+VALUE(TEXT(line.columns['R'].values['A']))}" var="rowTotalAColumnR"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnS}">
    <apex:variable value="{!rowTotalAColumnS+VALUE(TEXT(line.columns['S'].values['A']))}" var="rowTotalAColumnS"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnT}">
    <apex:variable value="{!rowTotalAColumnT+VALUE(TEXT(line.columns['T'].values['A']))}" var="rowTotalAColumnT"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnU}">
    <apex:variable value="{!rowTotalAColumnU+VALUE(TEXT(line.columns['U'].values['A']))}" var="rowTotalAColumnU"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnV}">
    <apex:variable value="{!rowTotalAColumnV+VALUE(TEXT(line.columns['V'].values['A']))}" var="rowTotalAColumnV"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnW}">
    <apex:variable value="{!rowTotalAColumnW+VALUE(TEXT(line.columns['W'].values['A']))}" var="rowTotalAColumnW"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnX}">
    <apex:variable value="{!rowTotalAColumnX+VALUE(TEXT(line.columns['X'].values['A']))}" var="rowTotalAColumnX"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnY}">
    <apex:variable value="{!rowTotalAColumnY+VALUE(TEXT(line.columns['Y'].values['A']))}" var="rowTotalAColumnY"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnZ}">
    <apex:variable value="{!rowTotalAColumnZ+VALUE(TEXT(line.columns['Z'].values['A']))}" var="rowTotalAColumnZ"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderAnyColumn}">
    <apex:variable value="{!rowTotalAColumnAll+lineTotalAA+lineTotalBA+lineTotalCA+lineTotalDA+lineTotalEA+lineTotalFA+lineTotalGA+lineTotalHA+lineTotalIA+lineTotalJA+lineTotalKA+lineTotalLA+lineTotalMA+lineTotalNA+lineTotalOA+lineTotalPA+lineTotalQA+lineTotalRA+lineTotalSA+lineTotalTA+lineTotalUA+lineTotalVA+lineTotalWA+lineTotalXA+lineTotalYA+lineTotalZA}" var="rowTotalAColumnAll"/>
    </apex:outputPanel>
    <!-- Row Column Totals for the second Sum type Reporting Value (Value = B) -->
    <apex:outputPanel layout="none" rendered="{!RenderColumnA}">
    <apex:variable value="{!rowTotalBColumnA+VALUE(TEXT(line.columns['A'].values['B']))}" var="rowTotalBColumnA"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnB}">
    <apex:variable value="{!rowTotalBColumnB+VALUE(TEXT(line.columns['B'].values['B']))}" var="rowTotalBColumnB"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnC}">
    <apex:variable value="{!rowTotalBColumnC+VALUE(TEXT(line.columns['C'].values['B']))}" var="rowTotalBColumnC"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnD}">
    <apex:variable value="{!rowTotalBColumnD+VALUE(TEXT(line.columns['D'].values['B']))}" var="rowTotalBColumnD"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnE}">
    <apex:variable value="{!rowTotalBColumnE+VALUE(TEXT(line.columns['E'].values['B']))}" var="rowTotalBColumnE"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnF}">
    <apex:variable value="{!rowTotalBColumnF+VALUE(TEXT(line.columns['F'].values['B']))}" var="rowTotalBColumnF"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnG}">
    <apex:variable value="{!rowTotalBColumnG+VALUE(TEXT(line.columns['G'].values['B']))}" var="rowTotalBColumnG"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnH}">
    <apex:variable value="{!rowTotalBColumnH+VALUE(TEXT(line.columns['H'].values['B']))}" var="rowTotalBColumnH"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnI}">
    <apex:variable value="{!rowTotalBColumnI+VALUE(TEXT(line.columns['I'].values['B']))}" var="rowTotalBColumnI"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnJ}">
    <apex:variable value="{!rowTotalBColumnJ+VALUE(TEXT(line.columns['J'].values['B']))}" var="rowTotalBColumnJ"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnK}">
    <apex:variable value="{!rowTotalBColumnK+VALUE(TEXT(line.columns['K'].values['B']))}" var="rowTotalBColumnK"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnL}">
    <apex:variable value="{!rowTotalBColumnL+VALUE(TEXT(line.columns['L'].values['B']))}" var="rowTotalBColumnL"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnM}">
    <apex:variable value="{!rowTotalBColumnM+VALUE(TEXT(line.columns['M'].values['B']))}" var="rowTotalBColumnM"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnN}">
    <apex:variable value="{!rowTotalBColumnN+VALUE(TEXT(line.columns['N'].values['B']))}" var="rowTotalBColumnN"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnO}">
    <apex:variable value="{!rowTotalBColumnO+VALUE(TEXT(line.columns['O'].values['B']))}" var="rowTotalBColumnO"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnP}">
    <apex:variable value="{!rowTotalBColumnP+VALUE(TEXT(line.columns['P'].values['B']))}" var="rowTotalBColumnP"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnQ}">
    <apex:variable value="{!rowTotalBColumnQ+VALUE(TEXT(line.columns['Q'].values['B']))}" var="rowTotalBColumnQ"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnR}">
    <apex:variable value="{!rowTotalBColumnR+VALUE(TEXT(line.columns['R'].values['B']))}" var="rowTotalBColumnR"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnS}">
    <apex:variable value="{!rowTotalBColumnS+VALUE(TEXT(line.columns['S'].values['B']))}" var="rowTotalBColumnS"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnT}">
    <apex:variable value="{!rowTotalBColumnT+VALUE(TEXT(line.columns['T'].values['B']))}" var="rowTotalBColumnT"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnU}">
    <apex:variable value="{!rowTotalBColumnU+VALUE(TEXT(line.columns['U'].values['B']))}" var="rowTotalBColumnU"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnV}">
    <apex:variable value="{!rowTotalBColumnV+VALUE(TEXT(line.columns['V'].values['B']))}" var="rowTotalBColumnV"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnW}">
    <apex:variable value="{!rowTotalBColumnW+VALUE(TEXT(line.columns['W'].values['B']))}" var="rowTotalBColumnW"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnX}">
    <apex:variable value="{!rowTotalBColumnX+VALUE(TEXT(line.columns['X'].values['B']))}" var="rowTotalBColumnX"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnY}">
    <apex:variable value="{!rowTotalBColumnY+VALUE(TEXT(line.columns['Y'].values['B']))}" var="rowTotalBColumnY"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderColumnZ}">
    <apex:variable value="{!rowTotalBColumnZ+VALUE(TEXT(line.columns['Z'].values['B']))}" var="rowTotalBColumnZ"/>
    </apex:outputPanel>
    <apex:outputPanel layout="none" rendered="{!RenderAnyColumn}">
    <apex:variable value="{!rowTotalBColumnAll+lineTotalAB+lineTotalBB+lineTotalCB+lineTotalDB+lineTotalEB+lineTotalFB+lineTotalGB+lineTotalHB+lineTotalIB+lineTotalJB+lineTotalKB+lineTotalLB+lineTotalMB+lineTotalNB+lineTotalOB+lineTotalPB+lineTotalQB+lineTotalRB+lineTotalSB+lineTotalTB+lineTotalUB+lineTotalVB+lineTotalWB+lineTotalXB+lineTotalYB+lineTotalZB}" var="rowTotalBColumnAll"/>
    </apex:outputPanel>
    </apex:repeat>
    <!-- Go to next line -->
    <!-- Do we want to process an end-of-row subtotal line? (only required for rows 1-99) -->
    <apex:outputPanel layout="none" rendered="{!rowKeyNum<=99 && RenderGroupSubtotals}">
    <tr>
    <!-- Display the group-group values but not the group-line values -->
    <td class="{!if(RenderGroup01,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup01}">{!previousLineGroup01}</apex:outputPanel></td>
    <td class="{!if(RenderGroup02,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup02}">{!previousLineGroup02}</apex:outputPanel></td>
    <td class="{!if(RenderGroup03,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup03}">{!previousLineGroup03}</apex:outputPanel></td>
    <td class="{!if(RenderGroup04,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup04}">{!previousLineGroup04}</apex:outputPanel></td>
    <td class="{!if(RenderGroup05,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup05}">{!previousLineGroup05}</apex:outputPanel></td>
    <td class="{!if(RenderGroup10,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup10}"></apex:outputPanel></td>
    <td class="{!if(RenderGroup11,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup11}"></apex:outputPanel></td>
    <td class="{!if(RenderGroup12,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup12}"></apex:outputPanel></td>
    <td class="{!if(RenderGroup13,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup13}"></apex:outputPanel></td>
    <td class="{!if(RenderGroup14,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup14}"></apex:outputPanel></td>
    <td class="{!if(RenderGroup15,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup15}"></apex:outputPanel></td>
    <td class="{!if(RenderGroup16,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup16}"></apex:outputPanel></td>
    <td class="{!if(RenderGroup17,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup17}"></apex:outputPanel></td>
    <td class="{!if(RenderGroup18,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup18}"></apex:outputPanel></td>
    <td class="{!if(RenderGroup19,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup19}"></apex:outputPanel></td>
    <td class="{!if(RenderGroup20,'ffrsubtotallabeld','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderGroup20}"></apex:outputPanel></td>
    <td class="ffrgridspacerd"/>
    <!-- For the first Sum type Reporting Value (Value = A) -->
    <td class="{!if(RenderColumnA,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnA}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnA}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnB,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnB}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnB}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnC,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnC}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnC}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnD,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnD}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnD}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnE,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnE}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnE}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnF,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnF}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnF}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnG,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnG}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnG}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnH,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnH}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnH}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnI,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnI}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnI}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnJ,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnJ}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnJ}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnK,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnK}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnK}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnL,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnL}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnL}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnM,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnM}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnM}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnN,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnN}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnN}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnO,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnO}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnO}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnP,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnP}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnP}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnQ,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnQ}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnQ}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnR,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnR}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnR}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnS,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnS}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnS}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnT,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnT}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnT}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnU,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnU}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnU}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnV,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnV}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnV}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnW,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnW}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnW}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnX,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnX}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnX}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnY,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnY}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnY}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnZ,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnZ}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnZ}"/></apex:outputPanel></td>
    <td class="ffrgridspacerd"/>
    <td class="{!if(RenderAnyColumn,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderAnyColumn}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalAColumnAll}"/></apex:outputPanel></td>
    <td class="ffrgridspacerd"/>
    <!-- For the second Sum type Reporting Value (Value = B) -->
    <td class="{!if(RenderColumnA,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnA}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnA}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnB,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnB}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnB}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnC,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnC}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnC}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnD,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnD}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnD}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnE,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnE}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnE}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnF,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnF}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnF}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnG,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnG}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnG}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnH,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnH}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnH}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnI,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnI}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnI}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnJ,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnJ}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnJ}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnK,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnK}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnK}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnL,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnL}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnL}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnM,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnM}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnM}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnN,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnN}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnN}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnO,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnO}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnO}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnP,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnP}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnP}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnQ,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnQ}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnQ}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnR,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnR}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnR}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnS,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnS}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnS}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnT,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnT}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnT}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnU,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnU}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnU}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnV,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnV}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnV}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnW,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnW}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnW}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnX,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnX}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnX}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnY,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnY}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnY}"/></apex:outputPanel></td>
    <td class="{!if(RenderColumnZ,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnZ}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnZ}"/></apex:outputPanel></td>
    <td class="ffrgridspacerd"/>
    <td class="{!if(RenderAnyColumn,'ffrsubtotald','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderAnyColumn}"><c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowSubtotalBColumnAll}"/></apex:outputPanel></td>
    <!-- Columns Total -->
    <!-- Running Total -->
    </tr>
    </apex:outputPanel>
    <!-- Setup for end of row -->
    <!-- Add the row-total to the grand-total so that the grand-total accumulates across all the rows -->
    <!-- Add up the values for the row total columns -->
    <!-- Note that the row-totals are reset for each successive row -->
    <tr><td class = "ffrhidden">
    <apex:variable value="{!0}" var="rowTotalA" />
    <apex:variable value="{!0}" var="rowTotalB" />
    <apex:variable value="{!0}" var="runningTotalA" />
    <apex:variable value="{!0}" var="runningTotalB" />
    <!-- End of row for the first Sum Type Reporting Value (Value = A) -->
    <apex:variable value="{!grandTotalAColumnA+rowTotalAColumnA}" var="grandTotalAColumnA" rendered="{!RenderColumnA}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnA}" var="rowTotalA" rendered="{!RenderColumnA}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnA}" var="runningTotalA" rendered="{!RenderColumnA}"/>
    <apex:variable value="{!grandTotalAColumnB+rowTotalAColumnB}" var="grandTotalAColumnB" rendered="{!RenderColumnB}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnB}" var="rowTotalA" rendered="{!RenderColumnB}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnB}" var="runningTotalA" rendered="{!RenderColumnB}"/>
    <apex:variable value="{!grandTotalAColumnC+rowTotalAColumnC}" var="grandTotalAColumnC" rendered="{!RenderColumnC}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnC}" var="rowTotalA" rendered="{!RenderColumnC}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnC}" var="runningTotalA" rendered="{!RenderColumnC}"/>
    <apex:variable value="{!grandTotalAColumnD+rowTotalAColumnD}" var="grandTotalAColumnD" rendered="{!RenderColumnD}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnD}" var="rowTotalA" rendered="{!RenderColumnD}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnD}" var="runningTotalA" rendered="{!RenderColumnD}"/>
    <apex:variable value="{!grandTotalAColumnE+rowTotalAColumnE}" var="grandTotalAColumnE" rendered="{!RenderColumnE}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnE}" var="rowTotalA" rendered="{!RenderColumnE}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnE}" var="runningTotalA" rendered="{!RenderColumnE}"/>
    <apex:variable value="{!grandTotalAColumnF+rowTotalAColumnF}" var="grandTotalAColumnF" rendered="{!RenderColumnF}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnF}" var="rowTotalA" rendered="{!RenderColumnF}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnF}" var="runningTotalA" rendered="{!RenderColumnF}"/>
    <apex:variable value="{!grandTotalAColumnG+rowTotalAColumnG}" var="grandTotalAColumnG" rendered="{!RenderColumnG}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnG}" var="rowTotalA" rendered="{!RenderColumnG}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnG}" var="runningTotalA" rendered="{!RenderColumnG}"/>
    <apex:variable value="{!grandTotalAColumnH+rowTotalAColumnH}" var="grandTotalAColumnH" rendered="{!RenderColumnH}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnH}" var="rowTotalA" rendered="{!RenderColumnH}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnH}" var="runningTotalA" rendered="{!RenderColumnH}"/>
    <apex:variable value="{!grandTotalAColumnI+rowTotalAColumnI}" var="grandTotalAColumnI" rendered="{!RenderColumnI}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnI}" var="rowTotalA" rendered="{!RenderColumnI}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnI}" var="runningTotalA" rendered="{!RenderColumnI}"/>
    <apex:variable value="{!grandTotalAColumnJ+rowTotalAColumnJ}" var="grandTotalAColumnJ" rendered="{!RenderColumnJ}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnJ}" var="rowTotalA" rendered="{!RenderColumnJ}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnJ}" var="runningTotalA" rendered="{!RenderColumnJ}"/>
    <apex:variable value="{!grandTotalAColumnK+rowTotalAColumnK}" var="grandTotalAColumnK" rendered="{!RenderColumnK}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnK}" var="rowTotalA" rendered="{!RenderColumnK}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnK}" var="runningTotalA" rendered="{!RenderColumnK}"/>
    <apex:variable value="{!grandTotalAColumnL+rowTotalAColumnL}" var="grandTotalAColumnL" rendered="{!RenderColumnL}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnL}" var="rowTotalA" rendered="{!RenderColumnL}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnL}" var="runningTotalA" rendered="{!RenderColumnL}"/>
    <apex:variable value="{!grandTotalAColumnM+rowTotalAColumnM}" var="grandTotalAColumnM" rendered="{!RenderColumnM}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnM}" var="rowTotalA" rendered="{!RenderColumnM}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnM}" var="runningTotalA" rendered="{!RenderColumnM}"/>
    <apex:variable value="{!grandTotalAColumnN+rowTotalAColumnN}" var="grandTotalAColumnN" rendered="{!RenderColumnN}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnN}" var="rowTotalA" rendered="{!RenderColumnN}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnN}" var="runningTotalA" rendered="{!RenderColumnN}"/>
    <apex:variable value="{!grandTotalAColumnO+rowTotalAColumnO}" var="grandTotalAColumnO" rendered="{!RenderColumnO}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnO}" var="rowTotalA" rendered="{!RenderColumnO}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnO}" var="runningTotalA" rendered="{!RenderColumnO}"/>
    <apex:variable value="{!grandTotalAColumnP+rowTotalAColumnP}" var="grandTotalAColumnP" rendered="{!RenderColumnP}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnP}" var="rowTotalA" rendered="{!RenderColumnP}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnP}" var="runningTotalA" rendered="{!RenderColumnP}"/>
    <apex:variable value="{!grandTotalAColumnQ+rowTotalAColumnQ}" var="grandTotalAColumnQ" rendered="{!RenderColumnQ}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnQ}" var="rowTotalA" rendered="{!RenderColumnQ}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnQ}" var="runningTotalA" rendered="{!RenderColumnQ}"/>
    <apex:variable value="{!grandTotalAColumnR+rowTotalAColumnR}" var="grandTotalAColumnR" rendered="{!RenderColumnR}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnR}" var="rowTotalA" rendered="{!RenderColumnR}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnR}" var="runningTotalA" rendered="{!RenderColumnR}"/>
    <apex:variable value="{!grandTotalAColumnS+rowTotalAColumnS}" var="grandTotalAColumnS" rendered="{!RenderColumnS}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnS}" var="rowTotalA" rendered="{!RenderColumnS}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnS}" var="runningTotalA" rendered="{!RenderColumnS}"/>
    <apex:variable value="{!grandTotalAColumnT+rowTotalAColumnT}" var="grandTotalAColumnT" rendered="{!RenderColumnT}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnT}" var="rowTotalA" rendered="{!RenderColumnT}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnT}" var="runningTotalA" rendered="{!RenderColumnT}"/>
    <apex:variable value="{!grandTotalAColumnU+rowTotalAColumnU}" var="grandTotalAColumnU" rendered="{!RenderColumnU}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnU}" var="rowTotalA" rendered="{!RenderColumnU}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnU}" var="runningTotalA" rendered="{!RenderColumnU}"/>
    <apex:variable value="{!grandTotalAColumnV+rowTotalAColumnV}" var="grandTotalAColumnV" rendered="{!RenderColumnV}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnV}" var="rowTotalA" rendered="{!RenderColumnV}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnV}" var="runningTotalA" rendered="{!RenderColumnV}"/>
    <apex:variable value="{!grandTotalAColumnW+rowTotalAColumnW}" var="grandTotalAColumnW" rendered="{!RenderColumnW}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnW}" var="rowTotalA" rendered="{!RenderColumnW}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnW}" var="runningTotalA" rendered="{!RenderColumnW}"/>
    <apex:variable value="{!grandTotalAColumnX+rowTotalAColumnX}" var="grandTotalAColumnX" rendered="{!RenderColumnX}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnX}" var="rowTotalA" rendered="{!RenderColumnX}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnX}" var="runningTotalA" rendered="{!RenderColumnX}"/>
    <apex:variable value="{!grandTotalAColumnY+rowTotalAColumnY}" var="grandTotalAColumnY" rendered="{!RenderColumnY}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnY}" var="rowTotalA" rendered="{!RenderColumnY}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnY}" var="runningTotalA" rendered="{!RenderColumnY}"/>
    <apex:variable value="{!grandTotalAColumnZ+rowTotalAColumnZ}" var="grandTotalAColumnZ" rendered="{!RenderColumnZ}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnZ}" var="rowTotalA" rendered="{!RenderColumnZ}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnZ}" var="runningTotalA" rendered="{!RenderColumnZ}"/>
    <apex:variable value="{!grandTotalAColumnAll+rowTotalAColumnAll}" var="grandTotalAColumnAll" rendered="{!RenderAnyColumn}"/>
    <apex:variable value="{!rowTotalA+rowTotalAColumnAll}" var="rowTotalA" rendered="{!RenderAnyColumn}"/>
    <apex:variable value="{!runningTotalA+grandTotalAColumnAll}" var="runningTotalA" rendered="{!RenderAnyColumn}"/>
    <!-- End of row for the second Sum Type Reporting Value (Value = B) -->
    <apex:variable value="{!grandTotalBColumnA+rowTotalBColumnA}" var="grandTotalBColumnA" rendered="{!RenderColumnA}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnA}" var="rowTotalB" rendered="{!RenderColumnA}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnA}" var="runningTotalB" rendered="{!RenderColumnA}"/>
    <apex:variable value="{!grandTotalBColumnB+rowTotalBColumnB}" var="grandTotalBColumnB" rendered="{!RenderColumnB}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnB}" var="rowTotalB" rendered="{!RenderColumnB}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnB}" var="runningTotalB" rendered="{!RenderColumnB}"/>
    <apex:variable value="{!grandTotalBColumnC+rowTotalBColumnC}" var="grandTotalBColumnC" rendered="{!RenderColumnC}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnC}" var="rowTotalB" rendered="{!RenderColumnC}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnC}" var="runningTotalB" rendered="{!RenderColumnC}"/>
    <apex:variable value="{!grandTotalBColumnD+rowTotalBColumnD}" var="grandTotalBColumnD" rendered="{!RenderColumnD}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnD}" var="rowTotalB" rendered="{!RenderColumnD}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnD}" var="runningTotalB" rendered="{!RenderColumnD}"/>
    <apex:variable value="{!grandTotalBColumnE+rowTotalBColumnE}" var="grandTotalBColumnE" rendered="{!RenderColumnE}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnE}" var="rowTotalB" rendered="{!RenderColumnE}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnE}" var="runningTotalB" rendered="{!RenderColumnE}"/>
    <apex:variable value="{!grandTotalBColumnF+rowTotalBColumnF}" var="grandTotalBColumnF" rendered="{!RenderColumnF}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnF}" var="rowTotalB" rendered="{!RenderColumnF}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnF}" var="runningTotalB" rendered="{!RenderColumnF}"/>
    <apex:variable value="{!grandTotalBColumnG+rowTotalBColumnG}" var="grandTotalBColumnG" rendered="{!RenderColumnG}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnG}" var="rowTotalB" rendered="{!RenderColumnG}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnG}" var="runningTotalB" rendered="{!RenderColumnG}"/>
    <apex:variable value="{!grandTotalBColumnH+rowTotalBColumnH}" var="grandTotalBColumnH" rendered="{!RenderColumnH}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnH}" var="rowTotalB" rendered="{!RenderColumnH}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnH}" var="runningTotalB" rendered="{!RenderColumnH}"/>
    <apex:variable value="{!grandTotalBColumnI+rowTotalBColumnI}" var="grandTotalBColumnI" rendered="{!RenderColumnI}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnI}" var="rowTotalB" rendered="{!RenderColumnI}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnI}" var="runningTotalB" rendered="{!RenderColumnI}"/>
    <apex:variable value="{!grandTotalBColumnJ+rowTotalBColumnJ}" var="grandTotalBColumnJ" rendered="{!RenderColumnJ}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnJ}" var="rowTotalB" rendered="{!RenderColumnJ}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnJ}" var="runningTotalB" rendered="{!RenderColumnJ}"/>
    <apex:variable value="{!grandTotalBColumnK+rowTotalBColumnK}" var="grandTotalBColumnK" rendered="{!RenderColumnK}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnK}" var="rowTotalB" rendered="{!RenderColumnK}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnK}" var="runningTotalB" rendered="{!RenderColumnK}"/>
    <apex:variable value="{!grandTotalBColumnL+rowTotalBColumnL}" var="grandTotalBColumnL" rendered="{!RenderColumnL}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnL}" var="rowTotalB" rendered="{!RenderColumnL}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnL}" var="runningTotalB" rendered="{!RenderColumnL}"/>
    <apex:variable value="{!grandTotalBColumnM+rowTotalBColumnM}" var="grandTotalBColumnM" rendered="{!RenderColumnM}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnM}" var="rowTotalB" rendered="{!RenderColumnM}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnM}" var="runningTotalB" rendered="{!RenderColumnM}"/>
    <apex:variable value="{!grandTotalBColumnN+rowTotalBColumnN}" var="grandTotalBColumnN" rendered="{!RenderColumnN}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnN}" var="rowTotalB" rendered="{!RenderColumnN}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnN}" var="runningTotalB" rendered="{!RenderColumnN}"/>
    <apex:variable value="{!grandTotalBColumnO+rowTotalBColumnO}" var="grandTotalBColumnO" rendered="{!RenderColumnO}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnO}" var="rowTotalB" rendered="{!RenderColumnO}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnO}" var="runningTotalB" rendered="{!RenderColumnO}"/>
    <apex:variable value="{!grandTotalBColumnP+rowTotalBColumnP}" var="grandTotalBColumnP" rendered="{!RenderColumnP}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnP}" var="rowTotalB" rendered="{!RenderColumnP}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnP}" var="runningTotalB" rendered="{!RenderColumnP}"/>
    <apex:variable value="{!grandTotalBColumnQ+rowTotalBColumnQ}" var="grandTotalBColumnQ" rendered="{!RenderColumnQ}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnQ}" var="rowTotalB" rendered="{!RenderColumnQ}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnQ}" var="runningTotalB" rendered="{!RenderColumnQ}"/>
    <apex:variable value="{!grandTotalBColumnR+rowTotalBColumnR}" var="grandTotalBColumnR" rendered="{!RenderColumnR}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnR}" var="rowTotalB" rendered="{!RenderColumnR}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnR}" var="runningTotalB" rendered="{!RenderColumnR}"/>
    <apex:variable value="{!grandTotalBColumnS+rowTotalBColumnS}" var="grandTotalBColumnS" rendered="{!RenderColumnS}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnS}" var="rowTotalB" rendered="{!RenderColumnS}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnS}" var="runningTotalB" rendered="{!RenderColumnS}"/>
    <apex:variable value="{!grandTotalBColumnT+rowTotalBColumnT}" var="grandTotalBColumnT" rendered="{!RenderColumnT}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnT}" var="rowTotalB" rendered="{!RenderColumnT}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnT}" var="runningTotalB" rendered="{!RenderColumnT}"/>
    <apex:variable value="{!grandTotalBColumnU+rowTotalBColumnU}" var="grandTotalBColumnU" rendered="{!RenderColumnU}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnU}" var="rowTotalB" rendered="{!RenderColumnU}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnU}" var="runningTotalB" rendered="{!RenderColumnU}"/>
    <apex:variable value="{!grandTotalBColumnV+rowTotalBColumnV}" var="grandTotalBColumnV" rendered="{!RenderColumnV}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnV}" var="rowTotalB" rendered="{!RenderColumnV}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnV}" var="runningTotalB" rendered="{!RenderColumnV}"/>
    <apex:variable value="{!grandTotalBColumnW+rowTotalBColumnW}" var="grandTotalBColumnW" rendered="{!RenderColumnW}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnW}" var="rowTotalB" rendered="{!RenderColumnW}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnW}" var="runningTotalB" rendered="{!RenderColumnW}"/>
    <apex:variable value="{!grandTotalBColumnX+rowTotalBColumnX}" var="grandTotalBColumnX" rendered="{!RenderColumnX}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnX}" var="rowTotalB" rendered="{!RenderColumnX}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnX}" var="runningTotalB" rendered="{!RenderColumnX}"/>
    <apex:variable value="{!grandTotalBColumnY+rowTotalBColumnY}" var="grandTotalBColumnY" rendered="{!RenderColumnY}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnY}" var="rowTotalB" rendered="{!RenderColumnY}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnY}" var="runningTotalB" rendered="{!RenderColumnY}"/>
    <apex:variable value="{!grandTotalBColumnZ+rowTotalBColumnZ}" var="grandTotalBColumnZ" rendered="{!RenderColumnZ}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnZ}" var="rowTotalB" rendered="{!RenderColumnZ}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnZ}" var="runningTotalB" rendered="{!RenderColumnZ}"/>
    <apex:variable value="{!grandTotalBColumnAll+rowTotalBColumnAll}" var="grandTotalBColumnAll" rendered="{!RenderAnyColumn}"/>
    <apex:variable value="{!rowTotalB+rowTotalBColumnAll}" var="rowTotalB" rendered="{!RenderAnyColumn}"/>
    <apex:variable value="{!runningTotalB+grandTotalBColumnAll}" var="runningTotalB" rendered="{!RenderAnyColumn}"/>
    <!-- Accumulate Sales Revenue if the row is in the range 1-10 -->
    <apex:outputPanel layout="none" rendered="{!rowKeyNum<11}">
    <!-- Sales Revenue for the first Sum Type Reporting Value (Value = A) -->
    <apex:variable value="{!salesRevenueTotalAColumnA+rowTotalAColumnA}" var="salesRevenueTotalAColumnA" rendered="{!RenderColumnA}"/>
    <apex:variable value="{!salesRevenueTotalAColumnB+rowTotalAColumnB}" var="salesRevenueTotalAColumnB" rendered="{!RenderColumnB}"/>
    <apex:variable value="{!salesRevenueTotalAColumnC+rowTotalAColumnC}" var="salesRevenueTotalAColumnC" rendered="{!RenderColumnC}"/>
    <apex:variable value="{!salesRevenueTotalAColumnD+rowTotalAColumnD}" var="salesRevenueTotalAColumnD" rendered="{!RenderColumnD}"/>
    <apex:variable value="{!salesRevenueTotalAColumnE+rowTotalAColumnE}" var="salesRevenueTotalAColumnE" rendered="{!RenderColumnE}"/>
    <apex:variable value="{!salesRevenueTotalAColumnF+rowTotalAColumnF}" var="salesRevenueTotalAColumnF" rendered="{!RenderColumnF}"/>
    <apex:variable value="{!salesRevenueTotalAColumnG+rowTotalAColumnG}" var="salesRevenueTotalAColumnG" rendered="{!RenderColumnG}"/>
    <apex:variable value="{!salesRevenueTotalAColumnH+rowTotalAColumnH}" var="salesRevenueTotalAColumnH" rendered="{!RenderColumnH}"/>
    <apex:variable value="{!salesRevenueTotalAColumnI+rowTotalAColumnI}" var="salesRevenueTotalAColumnI" rendered="{!RenderColumnI}"/>
    <apex:variable value="{!salesRevenueTotalAColumnJ+rowTotalAColumnJ}" var="salesRevenueTotalAColumnJ" rendered="{!RenderColumnJ}"/>
    <apex:variable value="{!salesRevenueTotalAColumnK+rowTotalAColumnK}" var="salesRevenueTotalAColumnK" rendered="{!RenderColumnK}"/>
    <apex:variable value="{!salesRevenueTotalAColumnL+rowTotalAColumnL}" var="salesRevenueTotalAColumnL" rendered="{!RenderColumnL}"/>
    <apex:variable value="{!salesRevenueTotalAColumnM+rowTotalAColumnM}" var="salesRevenueTotalAColumnM" rendered="{!RenderColumnM}"/>
    <apex:variable value="{!salesRevenueTotalAColumnN+rowTotalAColumnN}" var="salesRevenueTotalAColumnN" rendered="{!RenderColumnN}"/>
    <apex:variable value="{!salesRevenueTotalAColumnO+rowTotalAColumnO}" var="salesRevenueTotalAColumnO" rendered="{!RenderColumnO}"/>
    <apex:variable value="{!salesRevenueTotalAColumnP+rowTotalAColumnP}" var="salesRevenueTotalAColumnP" rendered="{!RenderColumnP}"/>
    <apex:variable value="{!salesRevenueTotalAColumnQ+rowTotalAColumnQ}" var="salesRevenueTotalAColumnQ" rendered="{!RenderColumnQ}"/>
    <apex:variable value="{!salesRevenueTotalAColumnR+rowTotalAColumnR}" var="salesRevenueTotalAColumnR" rendered="{!RenderColumnR}"/>
    <apex:variable value="{!salesRevenueTotalAColumnS+rowTotalAColumnS}" var="salesRevenueTotalAColumnS" rendered="{!RenderColumnS}"/>
    <apex:variable value="{!salesRevenueTotalAColumnT+rowTotalAColumnT}" var="salesRevenueTotalAColumnT" rendered="{!RenderColumnT}"/>
    <apex:variable value="{!salesRevenueTotalAColumnU+rowTotalAColumnU}" var="salesRevenueTotalAColumnU" rendered="{!RenderColumnU}"/>
    <apex:variable value="{!salesRevenueTotalAColumnV+rowTotalAColumnV}" var="salesRevenueTotalAColumnV" rendered="{!RenderColumnV}"/>
    <apex:variable value="{!salesRevenueTotalAColumnW+rowTotalAColumnW}" var="salesRevenueTotalAColumnW" rendered="{!RenderColumnW}"/>
    <apex:variable value="{!salesRevenueTotalAColumnX+rowTotalAColumnX}" var="salesRevenueTotalAColumnX" rendered="{!RenderColumnX}"/>
    <apex:variable value="{!salesRevenueTotalAColumnY+rowTotalAColumnY}" var="salesRevenueTotalAColumnY" rendered="{!RenderColumnY}"/>
    <apex:variable value="{!salesRevenueTotalAColumnZ+rowTotalAColumnZ}" var="salesRevenueTotalAColumnZ" rendered="{!RenderColumnZ}"/>
    <apex:variable value="{!salesRevenueTotalAColumnAll+rowTotalAColumnAll}" var="salesRevenueTotalAColumnAll" rendered="{!RenderAnyColumn}"/>
    <!-- Sales Revenue for the second Sum Type Reporting Value (Value = B) -->
    <apex:variable value="{!salesRevenueTotalBColumnA+rowTotalBColumnA}" var="salesRevenueTotalBColumnA" rendered="{!RenderColumnA}"/>
    <apex:variable value="{!salesRevenueTotalBColumnB+rowTotalBColumnB}" var="salesRevenueTotalBColumnB" rendered="{!RenderColumnB}"/>
    <apex:variable value="{!salesRevenueTotalBColumnC+rowTotalBColumnC}" var="salesRevenueTotalBColumnC" rendered="{!RenderColumnC}"/>
    <apex:variable value="{!salesRevenueTotalBColumnD+rowTotalBColumnD}" var="salesRevenueTotalBColumnD" rendered="{!RenderColumnD}"/>
    <apex:variable value="{!salesRevenueTotalBColumnE+rowTotalBColumnE}" var="salesRevenueTotalBColumnE" rendered="{!RenderColumnE}"/>
    <apex:variable value="{!salesRevenueTotalBColumnF+rowTotalBColumnF}" var="salesRevenueTotalBColumnF" rendered="{!RenderColumnF}"/>
    <apex:variable value="{!salesRevenueTotalBColumnG+rowTotalBColumnG}" var="salesRevenueTotalBColumnG" rendered="{!RenderColumnG}"/>
    <apex:variable value="{!salesRevenueTotalBColumnH+rowTotalBColumnH}" var="salesRevenueTotalBColumnH" rendered="{!RenderColumnH}"/>
    <apex:variable value="{!salesRevenueTotalBColumnI+rowTotalBColumnI}" var="salesRevenueTotalBColumnI" rendered="{!RenderColumnI}"/>
    <apex:variable value="{!salesRevenueTotalBColumnJ+rowTotalBColumnJ}" var="salesRevenueTotalBColumnJ" rendered="{!RenderColumnJ}"/>
    <apex:variable value="{!salesRevenueTotalBColumnK+rowTotalBColumnK}" var="salesRevenueTotalBColumnK" rendered="{!RenderColumnK}"/>
    <apex:variable value="{!salesRevenueTotalBColumnL+rowTotalBColumnL}" var="salesRevenueTotalBColumnL" rendered="{!RenderColumnL}"/>
    <apex:variable value="{!salesRevenueTotalBColumnM+rowTotalBColumnM}" var="salesRevenueTotalBColumnM" rendered="{!RenderColumnM}"/>
    <apex:variable value="{!salesRevenueTotalBColumnN+rowTotalBColumnN}" var="salesRevenueTotalBColumnN" rendered="{!RenderColumnN}"/>
    <apex:variable value="{!salesRevenueTotalBColumnO+rowTotalBColumnO}" var="salesRevenueTotalBColumnO" rendered="{!RenderColumnO}"/>
    <apex:variable value="{!salesRevenueTotalBColumnP+rowTotalBColumnP}" var="salesRevenueTotalBColumnP" rendered="{!RenderColumnP}"/>
    <apex:variable value="{!salesRevenueTotalBColumnQ+rowTotalBColumnQ}" var="salesRevenueTotalBColumnQ" rendered="{!RenderColumnQ}"/>
    <apex:variable value="{!salesRevenueTotalBColumnR+rowTotalBColumnR}" var="salesRevenueTotalBColumnR" rendered="{!RenderColumnR}"/>
    <apex:variable value="{!salesRevenueTotalBColumnS+rowTotalBColumnS}" var="salesRevenueTotalBColumnS" rendered="{!RenderColumnS}"/>
    <apex:variable value="{!salesRevenueTotalBColumnT+rowTotalBColumnT}" var="salesRevenueTotalBColumnT" rendered="{!RenderColumnT}"/>
    <apex:variable value="{!salesRevenueTotalBColumnU+rowTotalBColumnU}" var="salesRevenueTotalBColumnU" rendered="{!RenderColumnU}"/>
    <apex:variable value="{!salesRevenueTotalBColumnV+rowTotalBColumnV}" var="salesRevenueTotalBColumnV" rendered="{!RenderColumnV}"/>
    <apex:variable value="{!salesRevenueTotalBColumnW+rowTotalBColumnW}" var="salesRevenueTotalBColumnW" rendered="{!RenderColumnW}"/>
    <apex:variable value="{!salesRevenueTotalBColumnX+rowTotalBColumnX}" var="salesRevenueTotalBColumnX" rendered="{!RenderColumnX}"/>
    <apex:variable value="{!salesRevenueTotalBColumnY+rowTotalBColumnY}" var="salesRevenueTotalBColumnY" rendered="{!RenderColumnY}"/>
    <apex:variable value="{!salesRevenueTotalBColumnZ+rowTotalBColumnZ}" var="salesRevenueTotalBColumnZ" rendered="{!RenderColumnZ}"/>
    <apex:variable value="{!salesRevenueTotalBColumnAll+rowTotalBColumnAll}" var="salesRevenueTotalBColumnAll" rendered="{!RenderAnyColumn}"/>
    </apex:outputPanel></td></tr>
    <!-- Display the row totals -->
    <tr>
    <!--Display the title for the row-total - which is the row label -->
    <!-- The td tag needs to span the number of groups being rendered -->
    <td class="ffrgridsumlabeld" colspan="16">{!row.label}</td>
    <td class="ffrgridspacerd"/>
    <!-- Row Totals for the first Sum Type Reporting Value (Value = A) -->
    <td class="{!if(RenderColumnA,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnA}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnA}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnB,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnB}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnB}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnC,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnC}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnC}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnD,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnD}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnD}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnE,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnE}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnE}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnF,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnF}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnF}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnG,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnG}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnG}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnH,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnH}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnH}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnI,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnI}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnI}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnJ,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnJ}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnJ}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnK,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnK}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnK}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnL,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnL}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnL}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnM,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnM}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnM}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnN,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnN}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnN}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnO,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnO}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnO}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnP,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnP}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnP}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnQ,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnQ}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnQ}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnR,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnR}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnR}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnS,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnS}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnS}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnT,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnT}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnT}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnU,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnU}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnU}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnV,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnV}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnV}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnW,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnW}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnW}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnX,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnX}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnX}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnY,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnY}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnY}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnZ,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnZ}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnZ}"/>
    </apex:outputPanel></td>
    <td class="ffrgridspacerd"/>
    <td class="{!if(RenderAnyColumn,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderAnyColumn}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalAColumnAll}"/>
    </apex:outputPanel></td>
    <td class="ffrgridspacerd"/>
    <!-- Row Totals for the second Sum Type Reporting Value (Value = B) -->
    <td class="{!if(RenderColumnA,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnA}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnA}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnB,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnB}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnB}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnC,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnC}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnC}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnD,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnD}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnD}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnE,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnE}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnE}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnF,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnF}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnF}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnG,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnG}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnG}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnH,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnH}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnH}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnI,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnI}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnI}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnJ,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnJ}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnJ}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnK,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnK}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnK}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnL,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnL}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnL}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnM,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnM}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnM}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnN,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnN}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnN}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnO,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnO}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnO}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnP,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnP}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnP}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnQ,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnQ}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnQ}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnR,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnR}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnR}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnS,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnS}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnS}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnT,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnT}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnT}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnU,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnU}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnU}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnV,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnV}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnV}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnW,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnW}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnW}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnX,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnX}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnX}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnY,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnY}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnY}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnZ,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnZ}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnZ}"/>
    </apex:outputPanel></td>
    <td class="ffrgridspacerd"/>
    <td class="{!if(RenderAnyColumn,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderAnyColumn}">
    <c:NumberFormatter pattern="{!RowNumberPattern}" value="{!rowTotalBColumnAll}"/>
    </apex:outputPanel></td>
    <!-- Columns Total -->
    <!-- Running Total -->
    </tr>
    <!-- Make some vertical space before the next row -->
    <tr><td class="ffrgridspacerd" colspan="16"></td></tr>
    </apex:repeat><!-- Go to the next row -->
    <!-- Setup for grand-total row -->
    <!-- Initialise variable for the total for this row -->
    <apex:variable value="{!0}" var="rowTotalA"/>
    <apex:variable value="{!0}" var="rowTotalB"/>
    <tr><td class = "ffrhidden">
    <!-- For the first Sum Type Reporting Value (Value = A) -->
    <apex:variable value="{!rowTotalA+grandTotalAColumnA}" var="rowTotalA" rendered="{!RenderColumnA}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnB}" var="rowTotalA" rendered="{!RenderColumnB}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnC}" var="rowTotalA" rendered="{!RenderColumnC}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnD}" var="rowTotalA" rendered="{!RenderColumnD}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnE}" var="rowTotalA" rendered="{!RenderColumnE}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnF}" var="rowTotalA" rendered="{!RenderColumnF}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnG}" var="rowTotalA" rendered="{!RenderColumnG}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnH}" var="rowTotalA" rendered="{!RenderColumnH}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnI}" var="rowTotalA" rendered="{!RenderColumnI}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnJ}" var="rowTotalA" rendered="{!RenderColumnJ}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnK}" var="rowTotalA" rendered="{!RenderColumnK}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnL}" var="rowTotalA" rendered="{!RenderColumnL}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnM}" var="rowTotalA" rendered="{!RenderColumnM}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnN}" var="rowTotalA" rendered="{!RenderColumnN}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnO}" var="rowTotalA" rendered="{!RenderColumnO}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnP}" var="rowTotalA" rendered="{!RenderColumnP}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnQ}" var="rowTotalA" rendered="{!RenderColumnQ}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnR}" var="rowTotalA" rendered="{!RenderColumnR}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnS}" var="rowTotalA" rendered="{!RenderColumnS}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnT}" var="rowTotalA" rendered="{!RenderColumnT}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnU}" var="rowTotalA" rendered="{!RenderColumnU}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnV}" var="rowTotalA" rendered="{!RenderColumnV}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnW}" var="rowTotalA" rendered="{!RenderColumnW}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnX}" var="rowTotalA" rendered="{!RenderColumnX}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnY}" var="rowTotalA" rendered="{!RenderColumnY}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnZ}" var="rowTotalA" rendered="{!RenderColumnZ}"/>
    <apex:variable value="{!rowTotalA+grandTotalAColumnAll}" var="rowTotalA" rendered="{!RenderAnyColumn}"/>
    <!-- For the second Sum Type Reporting Value (Value = B) -->
    <apex:variable value="{!rowTotalB+grandTotalBColumnA}" var="rowTotalB" rendered="{!RenderColumnA}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnB}" var="rowTotalB" rendered="{!RenderColumnB}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnC}" var="rowTotalB" rendered="{!RenderColumnC}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnD}" var="rowTotalB" rendered="{!RenderColumnD}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnE}" var="rowTotalB" rendered="{!RenderColumnE}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnF}" var="rowTotalB" rendered="{!RenderColumnF}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnG}" var="rowTotalB" rendered="{!RenderColumnG}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnH}" var="rowTotalB" rendered="{!RenderColumnH}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnI}" var="rowTotalB" rendered="{!RenderColumnI}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnJ}" var="rowTotalB" rendered="{!RenderColumnJ}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnK}" var="rowTotalB" rendered="{!RenderColumnK}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnL}" var="rowTotalB" rendered="{!RenderColumnL}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnM}" var="rowTotalB" rendered="{!RenderColumnM}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnN}" var="rowTotalB" rendered="{!RenderColumnN}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnO}" var="rowTotalB" rendered="{!RenderColumnO}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnP}" var="rowTotalB" rendered="{!RenderColumnP}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnQ}" var="rowTotalB" rendered="{!RenderColumnQ}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnR}" var="rowTotalB" rendered="{!RenderColumnR}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnS}" var="rowTotalB" rendered="{!RenderColumnS}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnT}" var="rowTotalB" rendered="{!RenderColumnT}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnU}" var="rowTotalB" rendered="{!RenderColumnU}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnV}" var="rowTotalB" rendered="{!RenderColumnV}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnW}" var="rowTotalB" rendered="{!RenderColumnW}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnX}" var="rowTotalB" rendered="{!RenderColumnX}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnY}" var="rowTotalB" rendered="{!RenderColumnY}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnZ}" var="rowTotalB" rendered="{!RenderColumnZ}"/>
    <apex:variable value="{!rowTotalB+grandTotalBColumnAll}" var="rowTotalB" rendered="{!RenderAnyColumn}"/>
    </td></tr>
    <!-- Display grand-total row -->
    <tr>
    <!-- The td tag needs to span the number of groups being rendered -->
    <td class="ffrgridsumlabeld" colspan="16">{!Label['L12']}</td>
    <td class="ffrgridspacerd"/>
    <!-- Grand Total for the first Sum Type Reporting Value (Value = A) -->
    <td class="{!if(RenderColumnA,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnA}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnA}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnB,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnB}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnB}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnC,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnC}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnC}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnD,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnD}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnD}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnE,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnE}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnE}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnF,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnF}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnF}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnG,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnG}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnG}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnH,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnH}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnH}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnI,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnI}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnI}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnJ,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnJ}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnJ}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnK,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnK}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnK}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnL,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnL}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnL}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnM,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnM}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnM}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnN,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnN}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnN}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnO,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnO}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnO}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnP,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnP}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnP}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnQ,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnQ}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnQ}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnR,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnR}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnR}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnS,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnS}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnS}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnT,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnT}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnT}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnU,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnU}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnU}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnV,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnV}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnV}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnW,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnW}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnW}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnX,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnX}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnX}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnY,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnY}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnY}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnZ,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnZ}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnZ}"/>
    </apex:outputPanel></td>
    <td class="ffrgridspacerd"/>
    <td class="{!if(RenderAnyColumn,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderAnyColumn}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalAColumnAll}"/>
    </apex:outputPanel></td>
    <td class="ffrgridspacerd"/>
    <!-- Grand Total for the second Sum Type Reporting Value (Value = B) -->
    <td class="{!if(RenderColumnA,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnA}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnA}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnB,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnB}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnB}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnC,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnC}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnC}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnD,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnD}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnD}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnE,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnE}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnE}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnF,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnF}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnF}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnG,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnG}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnG}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnH,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnH}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnH}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnI,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnI}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnI}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnJ,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnJ}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnJ}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnK,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnK}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnK}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnL,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnL}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnL}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnM,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnM}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnM}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnN,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnN}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnN}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnO,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnO}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnO}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnP,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnP}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnP}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnQ,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnQ}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnQ}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnR,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnR}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnR}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnS,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnS}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnS}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnT,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnT}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnT}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnU,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnU}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnU}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnV,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnV}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnV}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnW,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnW}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnW}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnX,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnX}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnX}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnY,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnY}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnY}"/>
    </apex:outputPanel></td>
    <td class="{!if(RenderColumnZ,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnZ}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnZ}"/>
    </apex:outputPanel></td>
    <td class="ffrgridspacerd"/>
    <td class="{!if(RenderAnyColumn,'ffrgridsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderAnyColumn}">
    <c:NumberFormatter pattern="{!VR}" value="{!grandTotalBColumnAll}"/>
    </apex:outputPanel></td>
    <!-- Running Total is blank at grand-total level -->
    <!-- Spacer -->
    <tr><td class="ffrgridspacerd" colspan="16"></td></tr>
    <!-- Display Net Margin % -->
    <tr>
    <td class="ffrcalcsumlabeld" colspan="16">{!label['L13']}</td>
    <td class="ffrgridspacerd"/>
    <!-- Net Margin % for the first Sum Type Reporting Value (Value = A) -->
    <th class="{!if(RenderColumnA,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnA}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnA=0,0,grandTotalAColumnA/salesRevenueTotalAColumnA)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnB,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnB}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnB=0,0,grandTotalAColumnB/salesRevenueTotalAColumnB)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnC,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnC}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnC=0,0,grandTotalAColumnC/salesRevenueTotalAColumnC)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnD,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnD}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnD=0,0,grandTotalAColumnD/salesRevenueTotalAColumnD)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnE,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnE}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnE=0,0,grandTotalAColumnE/salesRevenueTotalAColumnE)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnF,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnF}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnF=0,0,grandTotalAColumnF/salesRevenueTotalAColumnF)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnG,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnG}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnG=0,0,grandTotalAColumnG/salesRevenueTotalAColumnG)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnH,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnH}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnH=0,0,grandTotalAColumnH/salesRevenueTotalAColumnH)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnI,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnI}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnI=0,0,grandTotalAColumnI/salesRevenueTotalAColumnI)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnJ,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnJ}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnJ=0,0,grandTotalAColumnJ/salesRevenueTotalAColumnJ)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnK,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnK}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnK=0,0,grandTotalAColumnK/salesRevenueTotalAColumnK)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnL,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnL}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnL=0,0,grandTotalAColumnL/salesRevenueTotalAColumnL)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnM,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnM}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnM=0,0,grandTotalAColumnM/salesRevenueTotalAColumnM)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnN,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnN}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnN=0,0,grandTotalAColumnN/salesRevenueTotalAColumnN)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnO,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnO}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnO=0,0,grandTotalAColumnO/salesRevenueTotalAColumnO)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnP,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnP}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnP=0,0,grandTotalAColumnP/salesRevenueTotalAColumnP)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnQ,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnQ}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnQ=0,0,grandTotalAColumnQ/salesRevenueTotalAColumnQ)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnR,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnR}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnR=0,0,grandTotalAColumnR/salesRevenueTotalAColumnR)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnS,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnS}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnS=0,0,grandTotalAColumnS/salesRevenueTotalAColumnS)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnT,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnT}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnT=0,0,grandTotalAColumnT/salesRevenueTotalAColumnT)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnU,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnU}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnU=0,0,grandTotalAColumnU/salesRevenueTotalAColumnU)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnV,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnV}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnV=0,0,grandTotalAColumnV/salesRevenueTotalAColumnV)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnW,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnW}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnW=0,0,grandTotalAColumnW/salesRevenueTotalAColumnW)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnX,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnX}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnX=0,0,grandTotalAColumnX/salesRevenueTotalAColumnX)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnY,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnY}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnY=0,0,grandTotalAColumnY/salesRevenueTotalAColumnY)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnZ,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnZ}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnZ=0,0,grandTotalAColumnZ/salesRevenueTotalAColumnZ)}"/></apex:outputPanel></th>
    <td class="ffrgridspacerd"/>
    <th class="{!if(RenderAnyColumn,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderAnyColumn}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalAColumnAll=0,0,grandTotalAColumnAll/salesRevenueTotalAColumnAll)}"/></apex:outputPanel></th>
    <td class="ffrgridspacerd"/>
    <!-- Net Margin % for the second Sum Type Reporting Value (Value = B) -->
    <th class="{!if(RenderColumnA,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnA}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnA=0,0,grandTotalBColumnA/salesRevenueTotalBColumnA)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnB,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnB}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnB=0,0,grandTotalBColumnB/salesRevenueTotalBColumnB)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnC,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnC}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnC=0,0,grandTotalBColumnC/salesRevenueTotalBColumnC)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnD,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnD}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnD=0,0,grandTotalBColumnD/salesRevenueTotalBColumnD)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnE,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnE}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnE=0,0,grandTotalBColumnE/salesRevenueTotalBColumnE)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnF,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnF}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnF=0,0,grandTotalBColumnF/salesRevenueTotalBColumnF)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnG,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnG}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnG=0,0,grandTotalBColumnG/salesRevenueTotalBColumnG)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnH,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnH}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnH=0,0,grandTotalBColumnH/salesRevenueTotalBColumnH)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnI,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnI}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnI=0,0,grandTotalBColumnI/salesRevenueTotalBColumnI)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnJ,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnJ}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnJ=0,0,grandTotalBColumnJ/salesRevenueTotalBColumnJ)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnK,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnK}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnK=0,0,grandTotalBColumnK/salesRevenueTotalBColumnK)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnL,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnL}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnL=0,0,grandTotalBColumnL/salesRevenueTotalBColumnL)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnM,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnM}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnM=0,0,grandTotalBColumnM/salesRevenueTotalBColumnM)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnN,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnN}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnN=0,0,grandTotalBColumnN/salesRevenueTotalBColumnN)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnO,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnO}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnO=0,0,grandTotalBColumnO/salesRevenueTotalBColumnO)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnP,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnP}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnP=0,0,grandTotalBColumnP/salesRevenueTotalBColumnP)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnQ,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnQ}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnQ=0,0,grandTotalBColumnQ/salesRevenueTotalBColumnQ)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnR,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnR}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnR=0,0,grandTotalBColumnR/salesRevenueTotalBColumnR)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnS,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnS}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnS=0,0,grandTotalBColumnS/salesRevenueTotalBColumnS)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnT,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnT}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnT=0,0,grandTotalBColumnT/salesRevenueTotalBColumnT)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnU,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnU}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnU=0,0,grandTotalBColumnU/salesRevenueTotalBColumnU)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnV,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnV}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnV=0,0,grandTotalBColumnV/salesRevenueTotalBColumnV)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnW,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnW}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnW=0,0,grandTotalBColumnW/salesRevenueTotalBColumnW)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnX,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnX}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnX=0,0,grandTotalBColumnX/salesRevenueTotalBColumnX)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnY,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnY}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnY=0,0,grandTotalBColumnY/salesRevenueTotalBColumnY)}"/></apex:outputPanel></th>
    <th class="{!if(RenderColumnZ,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderColumnZ}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnZ=0,0,grandTotalBColumnZ/salesRevenueTotalBColumnZ)}"/></apex:outputPanel></th>
    <td class="ffrgridspacerd"/>
    <th class="{!if(RenderAnyColumn,'ffrcalcsumd','ffrhidden')}"><apex:outputPanel layout="none" rendered="{!RenderAnyColumn}"><c:NumberFormatter pattern="{!PN}" value="{!if(salesRevenueTotalBColumnAll=0,0,grandTotalBColumnAll/salesRevenueTotalBColumnAll)}"/></apex:outputPanel></th>
    </tr>
    </tr>
    </table>
</apex:outputpanel>
<!-- REGION 06: REPORT CHATTER START -->
<c:ShowChatter value="{!ReportingLog}" rendered="{!PrintChatterFeed}"/>
<!-- REGION 06: REPORT CHATTER END -->
</apex:page>