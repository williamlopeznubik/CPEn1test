<!-- This page will be the step 4 -->
<apex:page controller="ffqs.CODAQSUserAccessController" sidebar="false" tabStyle="QuickStart__tab">
 	<apex:stylesheet value="{!URLFOR($Resource.ffqs__FinancialForce_Wizard,'styles/wizard.css')}" />
    <script src="{!URLFOR($Resource.FinancialForce_Wizard,'js/frameworks/prototype.js')}" type="text/javascript"></script>
    <script src="{!URLFOR($Resource.FinancialForce_Wizard,'js/frameworks/scriptaculous/scriptaculous.js')}" type="text/javascript"></script>
    <script src="{!URLFOR($Resource.FinancialForce_Wizard,'js/frameworks/scriptaculous/effects.js')}" type="text/javascript"></script>
    <script src="{!URLFOR($Resource.FinancialForce_Wizard,'js/wizard.js')}" type="text/javascript"></script>
	
	<div class="wizard" id="wizard">
		<div class="header">
		    <h2>{!$Label.codaextuseraccess}</h2>
		</div>
		
	    <div class="form">
	    <apex:form >
	        <div class="stepsWrapper">
	            <ul class="steps steps10">
	                <li class="on firstChild">
	                    <div><span class="step">1</span><span class="title"> {!$Label.codaextcompanydetails}</span></div>
	                </li>
	                <li class="on">
	                    <div><span class="step">2</span><span class="title"> {!$Label.codaexttaxregime}</span></div>
	                </li>
	                <li class="on on_current">
	                    <div><span class="step">3</span><span class="title"> {!$Label.codaexttaxdetails}</span></div>
	                </li>
	                <li class="current">
	                    <div><span class="step">4</span><span class="title"> {!$Label.codaextuseraccess}</span></div>
	                </li>
	                <li>
	                    <div><span class="step">5</span><span class="title"> {!$Label.codawzacccurrsetup}</span></div>
	                </li>
	                <li>
	                    <div><span class="step">6</span><span class="title"> {!$Label.codawzfinancialcalendar}</span></div>
	                </li>
	                <li>
	                    <div><span class="step">7</span><span class="title"> {!$Label.codawzchartofacc}</span></div>
	                </li>
	                <li>
	                    <div><span class="step">8</span><span class="title"> {!$Label.codaextaccountsreceivableanalysis}</span></div>
	                </li>
	                <li>
	                    <div><span class="step">9</span><span class="title"> {!$Label.codaextcreatecompany}</span></div>
	                </li>
	                <li class="lastChild">
	                    <div><span class="step">10</span><span class="title"> {!$Label.codaextactivatecompany}</span></div>
	                </li>
	            </ul>
	        </div>
        
	        <div class="information">
	            <h3>{!$Label.codaextuseraccessquestion}</h3>
	        </div>
	        
	        <apex:outputPanel id="messagePanel" layout="block">
	            <apex:outputPanel id="errorPanel" layout="block" styleClass="error" rendered="{!viewstate.showErrorMessages}">
	                <!--apex:messages/-->
	                <apex:repeat value="{!viewstate.errorMessages}" var="errorMessage" rendered="{!viewstate.showErrorMessages}">
	                    <h3><apex:outputText value="{!errorMessage}" /></h3>
	                </apex:repeat>
	            </apex:outputPanel>
	        </apex:outputPanel>
	        
	        <div class="left">      
	            <div class="row">
	                <apex:outputPanel layout="block" styleClass="scroller">
	                	<apex:repeat value="{!viewstate.userViews}" var="userView" first="0" rows="1">
			                <apex:dataTable id="dtUserCompanySelector" value="{!userView}" var="user" rowClasses="odd,even" styleClass="list largerLabel" width="100%" headerClass="listheader" border="0" onRowMouseOver="" onRowMouseOut="">                               
			                	<apex:column width="342px">
				                    <apex:outputLabel value="{!user.userName}"/>
			                    	<apex:facet name="header">
			                        	<apex:outputPanel styleClass="widthauto">
			                            	<apex:outputLabel value="{!$Label.codaextusername}"/>           
			                            </apex:outputPanel>                         
			                        </apex:facet>
			                    </apex:column>
				              	<apex:column >
				                	<apex:inputCheckbox id="ocb" value="{!user.selected}" disabled="{!user.isCurrent}"/>
				                    <apex:facet name="header">
					                    <apex:outputPanel styleClass="widthicon">
					                    	<input id="checkbox_selector" type="checkbox" value="0" />
					                   	</apex:outputPanel>
				                   	</apex:facet>                           
				               	</apex:column>                  
			          		</apex:dataTable>
			          	</apex:repeat>
			          	<apex:repeat value="{!viewstate.userViews}" var="userView" first="1">
			                <apex:dataTable id="dtUserCompanySelector" value="{!userView}" var="user" rowClasses="odd,even" styleClass="list largerLabel" width="100%" headerClass="listheader" border="0" onRowMouseOver="" onRowMouseOut="">                               
			                	<apex:column width="342px">
				                    <apex:outputLabel value="{!user.userName}"/>
			                    </apex:column>
				              	<apex:column >
				                	<apex:inputCheckbox id="ocb" value="{!user.selected}" disabled="{!user.isCurrent}"/>
				               	</apex:column>                  
			          		</apex:dataTable>
			          	</apex:repeat>
					</apex:outputPanel>
	            </div>
	        </div>
	        
	        <div class="right">
	            <div class="row">
	            	<div class="title"></div>
		            <div class="field">
		               	<!-- Hidden Buttons -->  
		                <apex:commandButton value="{!$Label.codaextnext}" action="{!nextPage}" id="next_h" styleclass="hiddensubmit"/>      
		                <apex:commandButton value="{!$Label.codaextprevious}" action="{!previousPage}" id="previous_h" styleclass="hiddensubmit"/>      
		                <apex:commandButton value="{!$Label.codaextsaveprogress}" action="{!saveProgress}" id="save_h" styleclass="hiddensubmit"/>      
		                <!-- End of Hidden Buttons -->
		                
		                <apex:commandButton value="{!$Label.codaextnext}" id="next" onclick="document.getElementById('{!$Component.next_h}').click();return false;" rerender=""/>    
		                <apex:commandButton value="{!$Label.codaextprevious}" id="previous" onclick="document.getElementById('{!$Component.previous_h}').click();return false;" rerender="" styleClass="btnLeft"/>                   
		                <apex:commandButton value="{!$Label.codaextsaveprogress}" id="saveProgress" onclick="document.getElementById('{!$Component.save_h}').click();return false;" rerender="" styleClass="btnSave btnRight"/>                   
	                </div>
	            </div>
	        </div>
	    </apex:form> 
	    </div>
    </div>
    <script type="text/javascript">
        document.fire("financialforce:dom:loaded");
        
	    var checkboxes = $$("form input[type=checkbox]");
	    var cbControl = $("checkbox_selector");
	    
	    cbControl.observe("click", function(){
	    	checkboxes.each(function(cb){
	    		if(cb.disabled == false)
	        		cb.checked = cbControl.checked;
	      	});
	    });
    </script>
</apex:page>